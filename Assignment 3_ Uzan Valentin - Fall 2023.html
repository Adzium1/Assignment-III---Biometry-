<!DOCTYPE html>
<!-- saved from url=(0022)http://localhost:6801/ -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-11-08">

<title>Assignment 3: Uzan Valentin - Fall 2023</title>
<style class="anchorjs"></style><style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="./Assignment 3_ Uzan Valentin - Fall 2023_files/clipboard.min.js.téléchargement"></script>
<script src="./Assignment 3_ Uzan Valentin - Fall 2023_files/quarto.js.téléchargement"></script>
<script src="./Assignment 3_ Uzan Valentin - Fall 2023_files/popper.min.js.téléchargement"></script>
<script src="./Assignment 3_ Uzan Valentin - Fall 2023_files/tippy.umd.min.js.téléchargement"></script>
<script src="./Assignment 3_ Uzan Valentin - Fall 2023_files/anchor.min.js.téléchargement"></script>
<link href="./Assignment 3_ Uzan Valentin - Fall 2023_files/tippy.css" rel="stylesheet">
<link href="./Assignment 3_ Uzan Valentin - Fall 2023_files/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="./Assignment 3_ Uzan Valentin - Fall 2023_files/bootstrap.min.js.téléchargement"></script>
<link href="./Assignment 3_ Uzan Valentin - Fall 2023_files/bootstrap-icons.css" rel="stylesheet">
<link href="./Assignment 3_ Uzan Valentin - Fall 2023_files/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">


<link id="nordvpn-contentScript-extension-fonts" rel="stylesheet" href="./Assignment 3_ Uzan Valentin - Fall 2023_files/css"></head>

<body class="quarto-dark">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="http://localhost:6801/#glm" id="toc-glm" class="nav-link active" data-scroll-target="#glm"><span class="header-section-number">1</span> <u>GLM</u></a>
  <ul class="">
  <li><a href="http://localhost:6801/#q1.-exploratory-analysis-of-the-variables" id="toc-q1.-exploratory-analysis-of-the-variables" class="nav-link" data-scroll-target="#q1.-exploratory-analysis-of-the-variables"><span class="header-section-number">1.1</span> Q1. Exploratory analysis of the variables</a></li>
  <li><a href="http://localhost:6801/#q2.-binomial-model-building" id="toc-q2.-binomial-model-building" class="nav-link" data-scroll-target="#q2.-binomial-model-building"><span class="header-section-number">1.2</span> Q2. Binomial model building</a></li>
  <li><a href="http://localhost:6801/#q3.-model-selection" id="toc-q3.-model-selection" class="nav-link" data-scroll-target="#q3.-model-selection"><span class="header-section-number">1.3</span> Q3. Model Selection</a></li>
  <li><a href="http://localhost:6801/#q4.-comparison-between-model" id="toc-q4.-comparison-between-model" class="nav-link" data-scroll-target="#q4.-comparison-between-model"><span class="header-section-number">1.4</span> Q4. Comparison between model</a></li>
  <li><a href="http://localhost:6801/#q5.-overdispersion" id="toc-q5.-overdispersion" class="nav-link" data-scroll-target="#q5.-overdispersion"><span class="header-section-number">1.5</span> Q5. Overdispersion</a></li>
  </ul></li>
  <li><a href="http://localhost:6801/#ancova" id="toc-ancova" class="nav-link" data-scroll-target="#ancova"><span class="header-section-number">2</span> <u>ANCOVA</u></a>
  <ul class="collapse">
  <li><a href="http://localhost:6801/#q6.-ancova-interpretation" id="toc-q6.-ancova-interpretation" class="nav-link" data-scroll-target="#q6.-ancova-interpretation"><span class="header-section-number">2.1</span> Q6. ANCOVA &amp; Interpretation</a></li>
  <li><a href="http://localhost:6801/#q7.-adjusted-mean" id="toc-q7.-adjusted-mean" class="nav-link" data-scroll-target="#q7.-adjusted-mean"><span class="header-section-number">2.2</span> Q7. Adjusted mean</a></li>
  <li><a href="http://localhost:6801/#q8.-one-way-anova" id="toc-q8.-one-way-anova" class="nav-link" data-scroll-target="#q8.-one-way-anova"><span class="header-section-number">2.3</span> Q8. <u>One-way ANOVA</u></a></li>
  <li><a href="http://localhost:6801/#q9.-tukey-test-fisher-lsd" id="toc-q9.-tukey-test-fisher-lsd" class="nav-link" data-scroll-target="#q9.-tukey-test-fisher-lsd"><span class="header-section-number">2.4</span> Q9. <u>Tukey Test &amp; Fisher LSD</u></a></li>
  <li><a href="http://localhost:6801/#q10.-nested-anova" id="toc-q10.-nested-anova" class="nav-link" data-scroll-target="#q10.-nested-anova"><span class="header-section-number">2.5</span> Q10. <u>Nested ANOVA</u></a></li>
  <li><a href="http://localhost:6801/#q11.-two-way-anova-without-replication" id="toc-q11.-two-way-anova-without-replication" class="nav-link" data-scroll-target="#q11.-two-way-anova-without-replication"><span class="header-section-number">2.6</span> Q11. <u>Two-Way ANOVA without replication</u></a></li>
  <li><a href="http://localhost:6801/#q12.-two-way-anova-with-replication" id="toc-q12.-two-way-anova-with-replication" class="nav-link" data-scroll-target="#q12.-two-way-anova-with-replication"><span class="header-section-number">2.7</span> Q12. <u>Two-Way ANOVA with replication</u></a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Assignment 3: Uzan Valentin - Fall 2023</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 8, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="glm" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> <u>GLM</u></h1>
<section id="q1.-exploratory-analysis-of-the-variables" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="q1.-exploratory-analysis-of-the-variables"><span class="header-section-number">1.1</span> Q1. Exploratory analysis of the variables<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6801/#q1.-exploratory-analysis-of-the-variables" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<ul>
<li><strong>Library &amp; read the data</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="http://localhost:6801/#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/uzanv/OneDrive/Documents/Asssignement_1"</span>)</span>
<span id="cb1-2"><a href="http://localhost:6801/#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-3"><a href="http://localhost:6801/#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="http://localhost:6801/#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="http://localhost:6801/#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.92 loaded</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="http://localhost:6801/#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gplots)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gplots'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    lowess</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="http://localhost:6801/#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ lubridate 1.9.3     ✔ tibble    3.2.1
✔ purrr     1.0.2     ✔ tidyr     1.3.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="http://localhost:6801/#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb13-2"><a href="http://localhost:6801/#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="http://localhost:6801/#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb15-2"><a href="http://localhost:6801/#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData

Attaching package: 'car'

The following object is masked from 'package:purrr':

    some

The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="http://localhost:6801/#cb17-1" aria-hidden="true" tabindex="-1"></a>sticklebacks <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"sticklebacks.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 200 Columns: 11
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
dbl (11): presence, area, dry, nutr, veg, fowl, pred, ponds, land, macro, HS

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<ul>
<li><strong>Bar Plots</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="http://localhost:6801/#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Exploration of Qualitative (categorical) variables </span></span>
<span id="cb19-2"><a href="http://localhost:6801/#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="http://localhost:6801/#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sticklebacks, <span class="fu">aes</span>(<span class="at">x=</span> presence)) <span class="sc">+</span> </span>
<span id="cb19-4"><a href="http://localhost:6801/#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"salmon"</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb19-5"><a href="http://localhost:6801/#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Barplot of Presence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="http://localhost:6801/#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sticklebacks, <span class="fu">aes</span>(<span class="at">x=</span> fowl)) <span class="sc">+</span> </span>
<span id="cb20-2"><a href="http://localhost:6801/#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"salmon"</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb20-3"><a href="http://localhost:6801/#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Barplot of fowl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-2-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="http://localhost:6801/#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sticklebacks, <span class="fu">aes</span>(<span class="at">x=</span> pred)) <span class="sc">+</span> </span>
<span id="cb21-2"><a href="http://localhost:6801/#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"salmon"</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb21-3"><a href="http://localhost:6801/#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Barplot of pred"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-2-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><strong>Linear Model &amp; VIF</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="http://localhost:6801/#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#linear model</span></span>
<span id="cb22-2"><a href="http://localhost:6801/#cb22-2" aria-hidden="true" tabindex="-1"></a>model_st <span class="ot">&lt;-</span> <span class="fu">glm</span>(presence <span class="sc">~</span> area <span class="sc">+</span> dry <span class="sc">+</span> nutr <span class="sc">+</span> veg <span class="sc">+</span> fowl <span class="sc">+</span> pred <span class="sc">+</span> ponds <span class="sc">+</span> land <span class="sc">+</span> macro <span class="sc">+</span> HS, <span class="at">data =</span> sticklebacks)</span>
<span id="cb22-3"><a href="http://localhost:6801/#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="http://localhost:6801/#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_st)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = presence ~ area + dry + nutr + veg + fowl + pred + 
    ponds + land + macro + HS, data = sticklebacks)

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.415e+00  4.683e-01  -3.021 0.002871 ** 
area        -5.845e-05  3.296e-05  -1.773 0.077762 .  
dry          9.040e-02  4.494e-02   2.012 0.045678 *  
nutr        -1.235e-02  5.054e-02  -0.244 0.807193    
veg         -6.048e-04  1.113e-03  -0.544 0.587375    
fowl         1.362e-01  7.272e-02   1.873 0.062571 .  
pred         2.221e-02  9.151e-02   0.243 0.808485    
ponds        2.426e-02  1.595e-02   1.521 0.129980    
land        -8.767e-02  4.084e-02  -2.147 0.033085 *  
macro       -2.354e-04  1.659e-03  -0.142 0.887325    
HS           2.659e+00  7.639e-01   3.481 0.000621 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.1861142)

    Null deviance: 46.080  on 199  degrees of freedom
Residual deviance: 35.176  on 189  degrees of freedom
AIC: 243.98

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="http://localhost:6801/#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># VIF</span></span>
<span id="cb24-2"><a href="http://localhost:6801/#cb24-2" aria-hidden="true" tabindex="-1"></a>vif_model_st <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_st)</span>
<span id="cb24-3"><a href="http://localhost:6801/#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vif_model_st)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    area      dry     nutr      veg     fowl     pred    ponds     land 
1.225501 2.229892 1.719428 1.604874 1.351896 2.159546 1.224247 2.007150 
   macro       HS 
1.954872 6.338302 </code></pre>
</div>
</div>
<ul>
<li><strong>PCA</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="http://localhost:6801/#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- PCA</span></span>
<span id="cb26-2"><a href="http://localhost:6801/#cb26-2" aria-hidden="true" tabindex="-1"></a>sticklebacks_std <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(sticklebacks))</span>
<span id="cb26-3"><a href="http://localhost:6801/#cb26-3" aria-hidden="true" tabindex="-1"></a>pca_results <span class="ot">&lt;-</span> <span class="fu">PCA</span>(sticklebacks_std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="http://localhost:6801/#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(pca_results, </span>
<span id="cb27-2"><a href="http://localhost:6801/#cb27-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom.ind =</span> <span class="st">"point"</span>, </span>
<span id="cb27-3"><a href="http://localhost:6801/#cb27-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom.var =</span> <span class="st">"arrow"</span>,</span>
<span id="cb27-4"><a href="http://localhost:6801/#cb27-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">col.ind =</span> <span class="st">"blue"</span>, </span>
<span id="cb27-5"><a href="http://localhost:6801/#cb27-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">col.var =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-4-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="http://localhost:6801/#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(pca_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-4-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><strong>Pearson Correlation Heatmap</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="http://localhost:6801/#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Correlation matrix for continuous variables</span></span>
<span id="cb29-2"><a href="http://localhost:6801/#cb29-2" aria-hidden="true" tabindex="-1"></a>continuous <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"HS"</span>, <span class="st">"ponds"</span>, <span class="st">"area"</span>, <span class="st">"dry"</span>, <span class="st">"nutr"</span>, <span class="st">"veg"</span>, <span class="st">"macro"</span>)</span>
<span id="cb29-3"><a href="http://localhost:6801/#cb29-3" aria-hidden="true" tabindex="-1"></a>sticklebacks[continuous] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(sticklebacks[continuous], as.numeric)</span>
<span id="cb29-4"><a href="http://localhost:6801/#cb29-4" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(sticklebacks[continuous], <span class="at">use =</span> <span class="st">"complete.obs"</span>)  </span>
<span id="cb29-5"><a href="http://localhost:6801/#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(cor,</span>
<span id="cb29-6"><a href="http://localhost:6801/#cb29-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Pearson Correlation Heatmap"</span>,</span>
<span id="cb29-7"><a href="http://localhost:6801/#cb29-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">density.info =</span> <span class="st">"none"</span>,</span>
<span id="cb29-8"><a href="http://localhost:6801/#cb29-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">"none"</span>,</span>
<span id="cb29-9"><a href="http://localhost:6801/#cb29-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">8</span>),</span>
<span id="cb29-10"><a href="http://localhost:6801/#cb29-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"red"</span>))(<span class="dv">50</span>),</span>
<span id="cb29-11"><a href="http://localhost:6801/#cb29-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">cexRow =</span> <span class="fl">0.7</span>, </span>
<span id="cb29-12"><a href="http://localhost:6801/#cb29-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">cexCol =</span> <span class="fl">0.7</span>,</span>
<span id="cb29-13"><a href="http://localhost:6801/#cb29-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">dendrogram =</span> <span class="st">"both"</span>, </span>
<span id="cb29-14"><a href="http://localhost:6801/#cb29-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">Rowv =</span> <span class="cn">TRUE</span>,        </span>
<span id="cb29-15"><a href="http://localhost:6801/#cb29-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv =</span> <span class="cn">TRUE</span>,        </span>
<span id="cb29-16"><a href="http://localhost:6801/#cb29-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">cellnote =</span> <span class="fu">round</span>(cor, <span class="dv">2</span>), </span>
<span id="cb29-17"><a href="http://localhost:6801/#cb29-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">notecol =</span> <span class="st">"black"</span></span>
<span id="cb29-18"><a href="http://localhost:6801/#cb29-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><p><strong>Interpretation</strong></p></li>
<li><p><strong>Linear Model &amp; VIF</strong></p></li>
</ul>
<p>From the linear model, we can see that certain factors have a significant impact on the presence of stick, notably the variables <code>dry</code> (p-value = 0.045678 &lt; 0.05) <code>land</code> (p-value = 0.033085 &lt; 0.05) and <code>HS</code> (p-value = 0.000621&lt; 0.05), HS being the predictor with the greatest influence on presence, while <code>dry</code> and <code>land</code> are close to the threshold. Thus removing <code>HS</code> seems to be a good thing but we should do the same for ‘dry and land’ in order to avoid interractions in our model should be a good thing, but we will confirm this hypothesis during the AIC step. Note that the starting AIC for this model is given as <strong>243.98</strong>.</p>
<p>Furthermore, in the VIF results, there are no VIF values &gt;10 indicating multicollinearity, but we can see that the <code>HS</code> value is relatively high compared with the others (around 1.7 on average compared with 6.1 for <code>HS</code>), indicating that this variable should be taken into consideration.</p>
<ul>
<li><strong>PCA</strong></li>
</ul>
<p>Based on the results of the PCA plots, hypotheses can be made about the variables that could influence the model. Variables with the same relatively close direction, such as <code>HS</code> and <code>macro</code>, can interfere with the model, but as <code>HS</code> is a variable that combines with the other factors, we can remove it from the model since it will interact with our variables a fortciori. As the power of magnitude fluctuates between the variables but is not significantly low or too high, we will consider all the variables in our first model and carry out an AIC to confirm the hypotheses issued.</p>
<ul>
<li><strong>Correlation</strong></li>
</ul>
<p>According to the Heat map, the <code>HS</code> variable appears to have a strong to moderate positive correlation with <code>macro</code> (0.56), <code>nutr</code> (0.49) and <code>ponds</code> (0.34) variables, and also a negative correlation with <code>veg</code> (-0.44) and <code>dry</code> (-0.42), showing that this variable is likely to influence our model as previously postulated. Certain other variables appear to have moderate positive or negative correlations with each other, such as <code>macro-veg</code> (-0.33), <code>macro-nutr</code> (0.26) or <code>area-dry</code> (-0.27).</p>
<p>In conclusion, certain variables, in particular <code>HS</code>, which should be removed from the model, but also <code>dry</code>, <code>land</code> and potentially <code>macro</code> variables, should be considered as potential predictive factors for making interactions.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="q2.-binomial-model-building" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="q2.-binomial-model-building"><span class="header-section-number">1.2</span> Q2. Binomial model building<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6801/#q2.-binomial-model-building" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<ul>
<li><strong>Read &amp; Library</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="http://localhost:6801/#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb30-2"><a href="http://localhost:6801/#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb30-3"><a href="http://localhost:6801/#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="http://localhost:6801/#cb30-4" aria-hidden="true" tabindex="-1"></a>sticklebacks<span class="sc">$</span>dry <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sticklebacks<span class="sc">$</span>dry)</span>
<span id="cb30-5"><a href="http://localhost:6801/#cb30-5" aria-hidden="true" tabindex="-1"></a>sticklebacks<span class="sc">$</span>nutr <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sticklebacks<span class="sc">$</span>nutr)</span>
<span id="cb30-6"><a href="http://localhost:6801/#cb30-6" aria-hidden="true" tabindex="-1"></a>sticklebacks<span class="sc">$</span>land <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sticklebacks<span class="sc">$</span>land)</span>
<span id="cb30-7"><a href="http://localhost:6801/#cb30-7" aria-hidden="true" tabindex="-1"></a>sticklebacks<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sticklebacks<span class="sc">$</span>pred)</span>
<span id="cb30-8"><a href="http://localhost:6801/#cb30-8" aria-hidden="true" tabindex="-1"></a>sticklebacks<span class="sc">$</span>fowl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sticklebacks<span class="sc">$</span>fowl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="http://localhost:6801/#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the binomial model</span></span>
<span id="cb31-2"><a href="http://localhost:6801/#cb31-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(presence <span class="sc">~</span> area <span class="sc">+</span> dry <span class="sc">+</span> nutr <span class="sc">+</span> veg <span class="sc">+</span> fowl <span class="sc">+</span> pred <span class="sc">+</span> ponds <span class="sc">+</span> land <span class="sc">+</span> macro, </span>
<span id="cb31-3"><a href="http://localhost:6801/#cb31-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> sticklebacks, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb31-4"><a href="http://localhost:6801/#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model</span></span>
<span id="cb31-5"><a href="http://localhost:6801/#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = presence ~ area + dry + nutr + veg + fowl + pred + 
    ponds + land + macro, family = "binomial", data = sticklebacks)

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -3.8679363  1.1827278  -3.270 0.001074 ** 
area        -0.0002423  0.0002772  -0.874 0.382125    
dry2         1.2738166  0.5674919   2.245 0.024791 *  
dry3         0.1888932  0.5628145   0.336 0.737155    
dry4        -0.4361424  1.0162309  -0.429 0.667795    
nutr2        0.1337933  0.7501824   0.178 0.858450    
nutr3        1.0132310  0.7526913   1.346 0.178256    
nutr4        0.4069837  1.0178294   0.400 0.689264    
veg         -0.0161590  0.0065300  -2.475 0.013339 *  
fowl1       -0.1814366  0.4417265  -0.411 0.681260    
pred1       -0.1611280  0.4927964  -0.327 0.743693    
ponds        0.2843682  0.0944151   3.012 0.002596 ** 
land2        2.4290757  0.8271033   2.937 0.003316 ** 
land3        2.8815114  0.7507944   3.838 0.000124 ***
land4        0.8169621  0.7840456   1.042 0.297420    
macro        0.0129526  0.0079840   1.622 0.104733    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 261.37  on 199  degrees of freedom
Residual deviance: 172.79  on 184  degrees of freedom
AIC: 204.79

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="http://localhost:6801/#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the model's coefficients to a tidy dataframe</span></span>
<span id="cb33-2"><a href="http://localhost:6801/#cb33-2" aria-hidden="true" tabindex="-1"></a>tidy_model <span class="ot">&lt;-</span> <span class="fu">tidy</span>(model)</span>
<span id="cb33-3"><a href="http://localhost:6801/#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the coefficient plot</span></span>
<span id="cb33-4"><a href="http://localhost:6801/#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tidy_model, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> <span class="fu">reorder</span>(term, estimate), <span class="at">xmin =</span> estimate <span class="sc">-</span> std.error <span class="sc">*</span> <span class="fl">1.96</span>, <span class="at">xmax =</span> estimate <span class="sc">+</span> std.error <span class="sc">*</span> <span class="fl">1.96</span>)) <span class="sc">+</span></span>
<span id="cb33-5"><a href="http://localhost:6801/#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span>  </span>
<span id="cb33-6"><a href="http://localhost:6801/#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-7"><a href="http://localhost:6801/#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="at">height =</span> <span class="fl">0.1</span>) <span class="sc">+</span>  </span>
<span id="cb33-8"><a href="http://localhost:6801/#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Coefficient Plot for Sticklebacks Model"</span>, <span class="at">x =</span> <span class="st">"Coefficient Estimate"</span>, <span class="at">y =</span> <span class="st">"Predictors"</span>) <span class="sc">+</span></span>
<span id="cb33-9"><a href="http://localhost:6801/#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><strong>Interpretation</strong></li>
</ul>
<p>The model summary indicates an interaction with the variables <code>nutr</code>, <code>ponds</code> and <code>macro</code> as positive predictors with a statistically significant association (p-value &lt;0.05) with the presence of sticklebacks.</p>
<p>Conversely, vegetation <code>veg</code> appeared as a negative predictor, indicating that denser vegetation might discourage the presence of sticklebacks. The fit of the model, indicated by a substantial reduction in deviance and a relatively low AIC, suggests that these variables together provide a significant explanation of the data.</p>
<p>The graph confirms the results obtained in the summary, particularly for the positive influence of the predictors <code>nutr</code>, <code>ponds</code> and <code>macro</code> , but the model also shows us that the <code>pred</code> variable stands out with a negative coefficient, indicating a strong inverse relationship between the presence of predators and sticklebacks. Conversely, many predictor variables, such as <code>nutr</code> and <code>fowl</code> have confidence intervals that cross the zero line, indicating that there is no clear evidence of their impact on stickleback presence.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="q3.-model-selection" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="q3.-model-selection"><span class="header-section-number">1.3</span> Q3. Model Selection<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6801/#q3.-model-selection" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="http://localhost:6801/#cb34-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(presence <span class="sc">~</span> area <span class="sc">+</span> dry <span class="sc">+</span> nutr <span class="sc">+</span> veg <span class="sc">+</span> fowl <span class="sc">+</span> pred <span class="sc">+</span> ponds <span class="sc">+</span> land <span class="sc">+</span> macro,</span>
<span id="cb34-2"><a href="http://localhost:6801/#cb34-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> sticklebacks, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb34-3"><a href="http://localhost:6801/#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="http://localhost:6801/#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Remove the predictor with the highest p-value (provided it's greater than a threshold, say 0.05)</span></span>
<span id="cb34-5"><a href="http://localhost:6801/#cb34-5" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">step</span>(model1, <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">trace =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=204.79
presence ~ area + dry + nutr + veg + fowl + pred + ponds + land + 
    macro

        Df Deviance    AIC
- pred   1   172.89 202.89
- fowl   1   172.96 202.96
- nutr   3   177.02 203.02
- area   1   173.80 203.80
&lt;none&gt;       172.79 204.79
- macro  1   175.42 205.42
- dry    3   180.95 206.95
- veg    1   179.20 209.20
- ponds  1   182.37 212.37
- land   3   203.34 229.34

Step:  AIC=202.89
presence ~ area + dry + nutr + veg + fowl + ponds + land + macro

        Df Deviance    AIC
- nutr   3   177.03 201.03
- fowl   1   173.17 201.17
- area   1   173.88 201.88
&lt;none&gt;       172.89 202.89
- macro  1   175.63 203.63
- dry    3   181.44 205.44
- veg    1   179.40 207.40
- ponds  1   183.06 211.06
- land   3   204.49 228.49

Step:  AIC=201.02
presence ~ area + dry + veg + fowl + ponds + land + macro

        Df Deviance    AIC
- fowl   1   177.68 199.68
- area   1   178.08 200.08
&lt;none&gt;       177.03 201.03
- dry    3   186.07 204.07
- macro  1   182.20 204.20
- veg    1   184.28 206.28
- ponds  1   186.77 208.77
- land   3   208.53 226.53

Step:  AIC=199.68
presence ~ area + dry + veg + ponds + land + macro

        Df Deviance    AIC
- area   1   179.24 199.24
&lt;none&gt;       177.68 199.68
- macro  1   182.86 202.86
- dry    3   187.06 203.06
- veg    1   184.67 204.67
- ponds  1   187.87 207.87
- land   3   208.59 224.59

Step:  AIC=199.24
presence ~ dry + veg + ponds + land + macro

        Df Deviance    AIC
&lt;none&gt;       179.24 199.24
- macro  1   185.56 203.56
- veg    1   185.60 203.60
- dry    3   190.20 204.20
- ponds  1   189.33 207.33
- land   3   209.98 223.98</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="http://localhost:6801/#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the final model summary</span></span>
<span id="cb36-2"><a href="http://localhost:6801/#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = presence ~ dry + veg + ponds + land + macro, family = "binomial", 
    data = sticklebacks)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -3.806238   0.870492  -4.373 1.23e-05 ***
dry2         1.432840   0.499192   2.870 0.004101 ** 
dry3         0.398436   0.483258   0.824 0.409668    
dry4        -0.463155   0.887360  -0.522 0.601707    
veg         -0.015192   0.006166  -2.464 0.013743 *  
ponds        0.285339   0.093365   3.056 0.002242 ** 
land2        2.493480   0.805720   3.095 0.001970 ** 
land3        2.738660   0.730216   3.750 0.000176 ***
land4        0.857598   0.759996   1.128 0.259141    
macro        0.019205   0.007670   2.504 0.012277 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 261.37  on 199  degrees of freedom
Residual deviance: 179.24  on 190  degrees of freedom
AIC: 199.24

Number of Fisher Scoring iterations: 5</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="http://localhost:6801/#cb38-1" aria-hidden="true" tabindex="-1"></a>tidy_model2 <span class="ot">&lt;-</span> <span class="fu">tidy</span>(model2)</span>
<span id="cb38-2"><a href="http://localhost:6801/#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the coefficient plot for the reduced model</span></span>
<span id="cb38-3"><a href="http://localhost:6801/#cb38-3" aria-hidden="true" tabindex="-1"></a>tidy_model2<span class="sc">$</span>significant <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tidy_model2<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Significant"</span>, <span class="st">"Not Significant"</span>)</span>
<span id="cb38-4"><a href="http://localhost:6801/#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="http://localhost:6801/#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Enhanced plot</span></span>
<span id="cb38-6"><a href="http://localhost:6801/#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tidy_model2, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> <span class="fu">reorder</span>(term, estimate), <span class="at">xmin =</span> estimate <span class="sc">-</span> std.error <span class="sc">*</span> <span class="fl">1.96</span>, <span class="at">xmax =</span> estimate <span class="sc">+</span> std.error <span class="sc">*</span> <span class="fl">1.96</span>)) <span class="sc">+</span></span>
<span id="cb38-7"><a href="http://localhost:6801/#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray80"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb38-8"><a href="http://localhost:6801/#cb38-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> <span class="fu">abs</span>(estimate), <span class="at">color =</span> significant)) <span class="sc">+</span></span>
<span id="cb38-9"><a href="http://localhost:6801/#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">color =</span> significant), <span class="at">height =</span> <span class="fl">0.1</span>) <span class="sc">+</span>  </span>
<span id="cb38-10"><a href="http://localhost:6801/#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Significant"</span> <span class="ot">=</span> <span class="st">"darkblue"</span>, <span class="st">"Not Significant"</span> <span class="ot">=</span> <span class="st">"darkred"</span>)) <span class="sc">+</span></span>
<span id="cb38-11"><a href="http://localhost:6801/#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb38-12"><a href="http://localhost:6801/#cb38-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effects of Predictors on Presence of Sticklebacks"</span>,</span>
<span id="cb38-13"><a href="http://localhost:6801/#cb38-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Points represent coefficient estimates. Colors denote significance at 0.05 level."</span>,</span>
<span id="cb38-14"><a href="http://localhost:6801/#cb38-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Coefficient Estimate"</span>, </span>
<span id="cb38-15"><a href="http://localhost:6801/#cb38-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predictors"</span>,</span>
<span id="cb38-16"><a href="http://localhost:6801/#cb38-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Significance"</span></span>
<span id="cb38-17"><a href="http://localhost:6801/#cb38-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-18"><a href="http://localhost:6801/#cb38-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb38-19"><a href="http://localhost:6801/#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><strong>Interpretation</strong></li>
</ul>
<p>Starting with a complete model including all the predictors, the AIC is initially <strong>239.85</strong>, then the <code>dry</code> variable is removed first to obtain a new AIC step of <strong>237.86</strong>. The next steps are to consider removing <code>land</code>, then <code>fowl</code>, each time with a lower AIC, suggesting that these variables do not contribute significantly to the predictive ability of the model.</p>
<p>The final model, which excludes <code>dry</code>, <code>land</code> and <code>fowl</code>, achieves an AIC of <strong>234.44</strong>. Indicating a more sparse model while retaining significant predictor variables such as <code>area</code>, <code>nutr</code>, <code>veg</code>, <code>pred,</code> <code>ponds</code> and <code>macro</code>, each contributing uniquely to the probability of stickleback presence, with <code>veg,</code> <code>nutr</code>, <code>ponds</code> and <code>macro</code> remaining statistically significant. We confirm our hypothesis as to the influence of the <code>dry</code> and <code>land</code> variables on the impact of the model.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="q4.-comparison-between-model" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="q4.-comparison-between-model"><span class="header-section-number">1.4</span> Q4. Comparison between model<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6801/#q4.-comparison-between-model" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="http://localhost:6801/#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the HS-only model</span></span>
<span id="cb40-2"><a href="http://localhost:6801/#cb40-2" aria-hidden="true" tabindex="-1"></a>hs_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(presence <span class="sc">~</span> HS, <span class="at">data =</span> sticklebacks, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb40-3"><a href="http://localhost:6801/#cb40-3" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(presence <span class="sc">~</span> area <span class="sc">+</span> dry <span class="sc">+</span> nutr <span class="sc">+</span> veg <span class="sc">+</span> fowl <span class="sc">+</span> pred <span class="sc">+</span> ponds <span class="sc">+</span> land <span class="sc">+</span> macro <span class="sc">+</span> HS, <span class="at">data =</span> sticklebacks, <span class="at">family =</span> <span class="st">"binomial"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="http://localhost:6801/#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain AIC and BIC for both models</span></span>
<span id="cb41-2"><a href="http://localhost:6801/#cb41-2" aria-hidden="true" tabindex="-1"></a>aic_reduced <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model3)</span>
<span id="cb41-3"><a href="http://localhost:6801/#cb41-3" aria-hidden="true" tabindex="-1"></a>aic_hs <span class="ot">&lt;-</span> <span class="fu">AIC</span>(hs_model)</span>
<span id="cb41-4"><a href="http://localhost:6801/#cb41-4" aria-hidden="true" tabindex="-1"></a>bic_reduced <span class="ot">&lt;-</span> <span class="fu">BIC</span>(model3)</span>
<span id="cb41-5"><a href="http://localhost:6801/#cb41-5" aria-hidden="true" tabindex="-1"></a>bic_hs <span class="ot">&lt;-</span> <span class="fu">BIC</span>(hs_model)</span>
<span id="cb41-6"><a href="http://localhost:6801/#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="http://localhost:6801/#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood Ratio Test</span></span>
<span id="cb41-8"><a href="http://localhost:6801/#cb41-8" aria-hidden="true" tabindex="-1"></a>lrt <span class="ot">&lt;-</span> <span class="fu">anova</span>(model3, hs_model, <span class="at">test=</span><span class="st">"Chisq"</span>)</span>
<span id="cb41-9"><a href="http://localhost:6801/#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="http://localhost:6801/#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb41-11"><a href="http://localhost:6801/#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC for reduced model:"</span>, aic_reduced, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>AIC for reduced model: 201.4871 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="http://localhost:6801/#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC for HS-only model:"</span>, aic_hs, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>AIC for HS-only model: 232.6665 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="http://localhost:6801/#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC for reduced model:"</span>, bic_reduced, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>BIC for reduced model: 257.5585 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="http://localhost:6801/#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC for HS-only model:"</span>, bic_hs, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>BIC for HS-only model: 239.2631 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="http://localhost:6801/#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lrt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table

Model 1: presence ~ area + dry + nutr + veg + fowl + pred + ponds + land + 
    macro + HS
Model 2: presence ~ HS
  Resid. Df Resid. Dev  Df Deviance  Pr(&gt;Chi)    
1       183     167.49                           
2       198     228.67 -15  -61.179 1.579e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Interpretation</strong></p>
<p>The model using the full set of predictors appears to perform better than the one using only HS as a predictor of stickleback presence. This is confirmed by lower AIC (<strong>225.7562</strong> vs <strong>232.6665)</strong> and higher BIC (<strong>262.0377</strong> vs <strong>239.26</strong>) values and significantly lower residual deviance in the complex model, indicating that it provides a better fit to the data while maintaining a balance between accuracy and simplicity. The deviance analysis table confirms this by showing a statistically significant improvement in model fit when additional predictors are included in addition to the <code>HS</code>. This confirms the <code>HS</code> model’s impact.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="q5.-overdispersion" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="q5.-overdispersion"><span class="header-section-number">1.5</span> Q5. Overdispersion<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6801/#q5.-overdispersion" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<ul>
<li><strong>What is Overdispersion ?</strong></li>
</ul>
<p>Overdispersion occurs in the GLM context when the variance of the response variable is greater than the mean, giving a residual difference in the fitted model that is greater than the degrees of freedom. As normal, these two factors increase at the same rate</p>
<ul>
<li><strong>How do you detect it ?</strong></li>
</ul>
<p>We can check the ratio of residual deviance and their degrees of freedom using this code: <code>(sum(residuals(pm3, type = "pearson") ^ 2) / pm3$df.residual)</code> or use the AER package, if the result is <strong>Result &gt; 1.5</strong> then we have overdispersion.</p>
<ul>
<li><strong>What can you do about it ?</strong></li>
</ul>
<p>To compensate for this model, we can apply a “quasi-Poisson” model. Similar but with mean and variance values: E(Yi) = μi and var(Yi) = φ μi. Thus we allow the variance to be proportional to the mean as in a standard Poisson GLM.</p>
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="ancova" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> <u>ANCOVA</u></h1>
<section id="q6.-ancova-interpretation" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="q6.-ancova-interpretation"><span class="header-section-number">2.1</span> Q6. ANCOVA &amp; Interpretation<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6801/#q6.-ancova-interpretation" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<ul>
<li><strong>Read Library &amp; data</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="http://localhost:6801/#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb51-2"><a href="http://localhost:6801/#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb51-3"><a href="http://localhost:6801/#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/uzanv/OneDrive/Documents/Asssignement_1"</span>)</span>
<span id="cb51-4"><a href="http://localhost:6801/#cb51-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"swim_speed.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><strong>Perform an anova</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="http://localhost:6801/#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1st way</span></span>
<span id="cb52-2"><a href="http://localhost:6801/#cb52-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">aov</span>(Speed <span class="sc">~</span> Fish <span class="sc">+</span> Temp, <span class="at">data =</span> data)</span>
<span id="cb52-3"><a href="http://localhost:6801/#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)    
Fish         2   8310    4155    1456 &lt;2e-16 ***
Temp         1   7026    7026    2462 &lt;2e-16 ***
Residuals   44    126       3                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="http://localhost:6801/#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visual representation of interaction (if significant)</span></span>
<span id="cb54-2"><a href="http://localhost:6801/#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Speed, <span class="at">y =</span> Temp, <span class="at">color =</span> Fish)) <span class="sc">+</span> </span>
<span id="cb54-3"><a href="http://localhost:6801/#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span>  </span>
<span id="cb54-4"><a href="http://localhost:6801/#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  </span>
<span id="cb54-5"><a href="http://localhost:6801/#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Fish) <span class="sc">+</span>  </span>
<span id="cb54-6"><a href="http://localhost:6801/#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb54-7"><a href="http://localhost:6801/#cb54-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between Speed and Temperature by Fish Type"</span>,</span>
<span id="cb54-8"><a href="http://localhost:6801/#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Speed"</span>,</span>
<span id="cb54-9"><a href="http://localhost:6801/#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Temperature"</span>,</span>
<span id="cb54-10"><a href="http://localhost:6801/#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Fish Type"</span></span>
<span id="cb54-11"><a href="http://localhost:6801/#cb54-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb54-12"><a href="http://localhost:6801/#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>  </span>
<span id="cb54-13"><a href="http://localhost:6801/#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb54-14"><a href="http://localhost:6801/#cb54-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),  </span>
<span id="cb54-15"><a href="http://localhost:6801/#cb54-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>  </span>
<span id="cb54-16"><a href="http://localhost:6801/#cb54-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Interpretation</strong></p>
<p>From the summary we can see that for the variables Fish and Temp both show significant effects with a p-value &lt; 0.05 (alpha threshold value) of 2.10-16 indicating respectively that there are differences in speed between fish species and that <code>Temperature</code> has an impact on speed.</p>
<p>Furthermore, we can confirm this by the visual interpretation offered by the graph, which shows the relationship between swimming speed and water temperature for three different types of fish designated <code>ex</code>, <code>fake</code> and <code>niv</code> .</p>
<p>Each graph shows a positive correlation between temperature and speed for the type of fish concerned. The 3 species each show a distinct linear relationship, with the data points following the line showing a relatively strong and positive correlation. This means that as temperature increases, the swimming speed of each type of fish also increases. The consistency of this trend between the three types of fish suggests that temperature is a significant factor influencing swimming speed.</p>
<p>By adding the continuous variable <code>Temperature</code>, we used covariance to take account of how this affects the swimming speeds of the different fish by influencing water temperature.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="q7.-adjusted-mean" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="q7.-adjusted-mean"><span class="header-section-number">2.2</span> Q7. Adjusted mean<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6801/#q7.-adjusted-mean" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<ul>
<li><strong>Read libraries &amp; data</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="http://localhost:6801/#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phia)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'phia' was built under R version 4.3.2</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="http://localhost:6801/#cb58-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Temp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data<span class="sc">$</span>Temp)</span>
<span id="cb58-2"><a href="http://localhost:6801/#cb58-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Fish <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>Fish)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><strong>Perform model mean</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="http://localhost:6801/#cb59-1" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Speed <span class="sc">~</span> Fish <span class="sc">*</span> Temp, <span class="at">data=</span>data)</span>
<span id="cb59-2"><a href="http://localhost:6801/#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Speed ~ Fish * Temp, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.7031 -1.3224 -0.1235  0.7092  3.6330 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   -11.0408     3.9586  -2.789  0.00791 ** 
Fishfake       25.6516     4.7312   5.422 2.68e-06 ***
Fishniv        -4.3484     4.7312  -0.919  0.36329    
Temp            3.7514     0.1527  24.570  &lt; 2e-16 ***
Fishfake:Temp  -0.2340     0.1915  -1.222  0.22865    
Fishniv:Temp   -0.2340     0.1915  -1.222  0.22865    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.693 on 42 degrees of freedom
Multiple R-squared:  0.9922,    Adjusted R-squared:  0.9913 
F-statistic:  1071 on 5 and 42 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="http://localhost:6801/#cb61-1" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">interactionMeans</span>(mod)</span>
<span id="cb61-2"><a href="http://localhost:6801/#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(means)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Fish   adjusted mean     std. error    
 ex  :1   Min.   :66.16   Min.   :0.4284  
 fake:1   1st Qu.:71.04   1st Qu.:0.4284  
 niv :1   Median :75.93   Median :0.4284  
          Mean   :79.41   Mean   :0.4854  
          3rd Qu.:86.04   3rd Qu.:0.5138  
          Max.   :96.16   Max.   :0.5992  </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="http://localhost:6801/#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(means, <span class="at">abbrev.levels=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Interpretation</strong></p>
<p>The graph shows the average swimming speeds for three types of fish, corrected for the influence of water temperature. <code>Fake</code> fish had the highest adjusted speed, significantly outstripping the <code>ex</code> and <code>niv</code> types. On the other hand, <code>ex</code> and <code>niv</code> fish show comparable speeds, as indicated by the overlapping confidence intervals. This visual suggests that while temperature has an overall impact on swimming speed, the <code>fake</code> fish type appears to be the fastest when this variable is taken into account.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="q8.-one-way-anova" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="q8.-one-way-anova"><span class="header-section-number">2.3</span> Q8. <u>One-way ANOVA</u><a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6801/#q8.-one-way-anova" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<ul>
<li><strong>Library &amp; read the data</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="http://localhost:6801/#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb64-2"><a href="http://localhost:6801/#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb64-3"><a href="http://localhost:6801/#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb64-4"><a href="http://localhost:6801/#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb64-5"><a href="http://localhost:6801/#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'agricolae'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:factoextra':

    hcut</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="http://localhost:6801/#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb67-2"><a href="http://localhost:6801/#cb67-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"grass.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><strong>A. Use any informative plotting show the data - Boxplot</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="http://localhost:6801/#cb68-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>treatment)</span>
<span id="cb68-2"><a href="http://localhost:6801/#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="http://localhost:6801/#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot with jittered points</span></span>
<span id="cb68-4"><a href="http://localhost:6801/#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> lenght, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb68-5"><a href="http://localhost:6801/#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb68-6"><a href="http://localhost:6801/#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="fu">aes</span>(<span class="at">color =</span> treatment)) <span class="sc">+</span> </span>
<span id="cb68-7"><a href="http://localhost:6801/#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Grass Growth by Treatment"</span>, <span class="at">x =</span> <span class="st">"Treatment"</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>) <span class="sc">+</span></span>
<span id="cb68-8"><a href="http://localhost:6801/#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><strong>B. Perform ONE-WAY ANOVA &amp; show the result</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="http://localhost:6801/#cb69-1" aria-hidden="true" tabindex="-1"></a>s_anova_model <span class="ot">&lt;-</span> <span class="fu">aov</span>(lenght <span class="sc">~</span> treatment, <span class="at">data =</span> data)</span>
<span id="cb69-2"><a href="http://localhost:6801/#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(s_anova_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
treatment    4  283.4   70.86   18.83 1.52e-10 ***
Residuals   70  263.5    3.76                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="http://localhost:6801/#cb71-1" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(lenght <span class="sc">~</span> treatment, <span class="at">data=</span>data)</span>
<span id="cb71-2"><a href="http://localhost:6801/#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: lenght
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
treatment  4 283.43  70.858  18.826 1.516e-10 ***
Residuals 70 263.47   3.764                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="http://localhost:6801/#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lenght ~ treatment, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.3333 -1.3633 -0.0133  1.0500  4.8667 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       9.3133     0.5009  18.592  &lt; 2e-16 ***
treatmenttreat2   2.5867     0.7084   3.651 0.000499 ***
treatmenttreat3   0.2200     0.7084   0.311 0.757062    
treatmenttreat4   3.3133     0.7084   4.677 1.38e-05 ***
treatmenttreat5   5.1600     0.7084   7.284 3.78e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.94 on 70 degrees of freedom
Multiple R-squared:  0.5182,    Adjusted R-squared:  0.4907 
F-statistic: 18.83 on 4 and 70 DF,  p-value: 1.516e-10</code></pre>
</div>
</div>
<ul>
<li><p><strong>C. Interpreation of R-Squared</strong></p>
<ul>
<li><p><strong>ANOVA</strong></p>
<p>The summary shows a p-value below the 0.05 alpha threshold (1.52e-10) indicating that treatment has a significant impact on the length of the</p></li>
<li><p><strong>Linear regression model</strong></p>
<p>According to the analysis of variance of the regression model, the p-value is significant p-valu &lt; 0.05 confirming the result obtained with the ANOVA on the impact of treatment on length. Furthermore, according to the summary, the variables <code>treatmenttreat2</code> (p-value = 0.000499) <code>treatmenttreat4</code> (p-value = 1.38e-05) and <code>treatmenttreat5</code> (best impact with a p-value = 3.78e-10) have a significant impact on length (p-value &lt;0.05) whereas <code>treatmenttreat3</code> has no effect on length (p-value &gt; 0.05). The residuals appear to be well distributed and the model is therefore well centred.</p></li>
<li><p><strong>R-Squared</strong></p>
<p>The <strong>R-Squared</strong> obtained is 0.5182, showing that 51.82% of the variation in <code>length</code> can be explained by differences in <code>treatment</code>. This measure allows us to check the model’s adequacy by verifying the impact of the independent <code>treatment</code> variable on <code>length</code>.</p>
<p>The <strong>Adjusted R-squared</strong> of 0.4907 provides a more accurate measure than the R-squared by taking into account only the number of predictors in the model.</p></li>
</ul></li>
<li><p><strong>D. Power</strong></p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="http://localhost:6801/#cb75-1" aria-hidden="true" tabindex="-1"></a>power_result <span class="ot">&lt;-</span> <span class="fu">power.anova.test</span>(<span class="at">groups =</span> <span class="fu">length</span>(<span class="fu">unique</span>(data<span class="sc">$</span>treatment)), <span class="at">n =</span> <span class="dv">15</span>, </span>
<span id="cb75-2"><a href="http://localhost:6801/#cb75-2" aria-hidden="true" tabindex="-1"></a>                                <span class="at">between.var =</span> <span class="fl">4.723836</span>, </span>
<span id="cb75-3"><a href="http://localhost:6801/#cb75-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">within.var =</span> <span class="fl">3.763848</span>)</span>
<span id="cb75-4"><a href="http://localhost:6801/#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(power_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Balanced one-way analysis of variance power calculation 

         groups = 5
              n = 15
    between.var = 4.723836
     within.var = 3.763848
      sig.level = 0.05
          power = 1

NOTE: n is number in each group</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</section>
<section id="q9.-tukey-test-fisher-lsd" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="q9.-tukey-test-fisher-lsd"><span class="header-section-number">2.4</span> Q9. <u>Tukey Test &amp; Fisher LSD</u><a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6801/#q9.-tukey-test-fisher-lsd" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="http://localhost:6801/#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb77-2"><a href="http://localhost:6801/#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Anova</span></span>
<span id="cb77-3"><a href="http://localhost:6801/#cb77-3" aria-hidden="true" tabindex="-1"></a>anova_model <span class="ot">&lt;-</span> <span class="fu">aov</span>(lenght <span class="sc">~</span> treatment, <span class="at">data=</span>data)</span>
<span id="cb77-4"><a href="http://localhost:6801/#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
treatment    4  283.4   70.86   18.83 1.52e-10 ***
Residuals   70  263.5    3.76                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="http://localhost:6801/#cb79-1" aria-hidden="true" tabindex="-1"></a>tukey_results <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_model)</span>
<span id="cb79-2"><a href="http://localhost:6801/#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tukey_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = lenght ~ treatment, data = data)

$treatment
                    diff        lwr        upr     p adj
treat2-treat1  2.5866667  0.6030071  4.5703262 0.0044139
treat3-treat1  0.2200000 -1.7636596  2.2036596 0.9979327
treat4-treat1  3.3133333  1.3296738  5.2969929 0.0001312
treat5-treat1  5.1600000  3.1763404  7.1436596 0.0000000
treat3-treat2 -2.3666667 -4.3503262 -0.3830071 0.0113745
treat4-treat2  0.7266667 -1.2569929  2.7103262 0.8426237
treat5-treat2  2.5733333  0.5896738  4.5569929 0.0046829
treat4-treat3  3.0933333  1.1096738  5.0769929 0.0004017
treat5-treat3  4.9400000  2.9563404  6.9236596 0.0000000
treat5-treat4  1.8466667 -0.1369929  3.8303262 0.0800540</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="http://localhost:6801/#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot </span></span>
<span id="cb81-2"><a href="http://localhost:6801/#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="http://localhost:6801/#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Fisher LSD test</span></span>
<span id="cb82-2"><a href="http://localhost:6801/#cb82-2" aria-hidden="true" tabindex="-1"></a>lsd_result <span class="ot">&lt;-</span> <span class="fu">LSD.test</span>(anova_model, <span class="st">"treatment"</span>, <span class="at">p.adj=</span><span class="st">"none"</span>)</span>
<span id="cb82-3"><a href="http://localhost:6801/#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lsd_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$statistics
   MSerror Df     Mean       CV  t.value      LSD
  3.763848 70 11.56933 16.76902 1.994437 1.412881

$parameters
        test p.ajusted    name.t ntr alpha
  Fisher-LSD      none treatment   5  0.05

$means
          lenght      std  r        se       LCL      UCL  Min  Max   Q25  Q50
treat1  9.313333 1.633955 15 0.5009223  8.314275 10.31239  6.5 12.0  7.95  9.4
treat2 11.900000 1.962870 15 0.5009223 10.900942 12.89906  9.1 15.6 10.45 12.3
treat3  9.533333 2.413849 15 0.5009223  8.534275 10.53239  5.2 14.4  8.80  9.8
treat4 12.626667 1.842927 15 0.5009223 11.627609 13.62572 10.3 15.6 11.35 11.7
treat5 14.473333 1.753147 15 0.5009223 13.474275 15.47239 11.4 17.2 13.65 14.7
         Q75
treat1 10.40
treat2 12.80
treat3 10.85
treat4 14.40
treat5 15.35

$comparison
NULL

$groups
          lenght groups
treat5 14.473333      a
treat4 12.626667      b
treat2 11.900000      b
treat3  9.533333      c
treat1  9.313333      c

attr(,"class")
[1] "group"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="http://localhost:6801/#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lsd_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-19-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><p><strong>Interpretation</strong></p>
<ul>
<li><p><strong>Tukey post-HOC Test</strong></p>
<p>This test show us multiple comparisons between the treatments. <code>treat2-treat1</code> show a p-value of 0.0044139 which is statically significant (p-value &lt; 0.05) as same as <code>treat4-treat1</code>, <code>treat5-treat1</code>, <code>treat3-treat2</code>, <code>treat5-treat5</code>, <code>treat4-treat3</code> and <code>treat5-treat3</code>. Conversely, the comparisons between <code>treat3-treat1</code> , <code>treat4-treat2</code> and <code>treat5-treat4</code> shows differences due to the p-value &gt; 0.05.</p></li>
<li><p><strong>Fisher-LSD Test</strong></p>
<p>According to the result, treatment 5 has the highest average length and is significantly different from the others. Treatments 4 and 2 are statistically similar to each other and have greater lengths than treatments 3 and 1, which are also similar to each other. The test highlights the differences between the treatments, reinforcing the ANOVA and Tukey results obtained previously.</p></li>
</ul></li>
</ul>
<div style="page-break-after: always;"></div>
</section>
<section id="q10.-nested-anova" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="q10.-nested-anova"><span class="header-section-number">2.5</span> Q10. <u>Nested ANOVA</u><a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6801/#q10.-nested-anova" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<ul>
<li><strong>Read library &amp; data</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="http://localhost:6801/#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb85-2"><a href="http://localhost:6801/#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb85-3"><a href="http://localhost:6801/#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'nlme'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    collapse</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="http://localhost:6801/#cb88-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"tree.xlsx"</span>)</span>
<span id="cb88-2"><a href="http://localhost:6801/#cb88-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><strong>Perform Anova</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="http://localhost:6801/#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nested Anova</span></span>
<span id="cb89-2"><a href="http://localhost:6801/#cb89-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(Height <span class="sc">~</span> Forest<span class="sc">/</span>Tree, <span class="at">data=</span>data)</span>
<span id="cb89-3"><a href="http://localhost:6801/#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Forest       4 129.28   32.32 161.059 6.55e-15 ***
Forest:Tree  5   7.14    1.43   7.113 0.000572 ***
Residuals   20   4.01    0.20                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="http://localhost:6801/#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Post Hoc</span></span>
<span id="cb91-2"><a href="http://localhost:6801/#cb91-2" aria-hidden="true" tabindex="-1"></a>HOC <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result, <span class="st">"Forest"</span>)</span>
<span id="cb91-3"><a href="http://localhost:6801/#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(HOC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Height ~ Forest/Tree, data = data)

$Forest
          diff         lwr        upr     p adj
B-A  3.2166667  2.44275224  3.9905811 0.0000000
C-A -1.7333333 -2.50724776 -0.9594189 0.0000145
D-A  3.9333333  3.15941890  4.7072478 0.0000000
E-A  1.0833333  0.30941890  1.8572478 0.0036850
C-B -4.9500000 -5.72391443 -4.1760856 0.0000000
D-B  0.7166667 -0.05724776  1.4905811 0.0779332
E-B -2.1333333 -2.90724776 -1.3594189 0.0000007
D-C  5.6666667  4.89275224  6.4405811 0.0000000
E-C  2.8166667  2.04275224  3.5905811 0.0000000
E-D -2.8500000 -3.62391443 -2.0760856 0.0000000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="http://localhost:6801/#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(HOC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><strong>Interpretation</strong></li>
</ul>
<p>According to the summary, the effect of the forest on the type of tree seems to have a significant impact with the Forest variable (p-value = 6.55e-15 &lt; 0.05) and the <code>Forest:Tree</code> interaction (p-value = 0.000572 &lt; 0.05) statistically significant. Moreover, according to the post-HOC test, all the groups show statistically significant differences (p-value &lt; 0.05).</p>
<div style="page-break-after: always;"></div>
</section>
<section id="q11.-two-way-anova-without-replication" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="q11.-two-way-anova-without-replication"><span class="header-section-number">2.6</span> Q11. <u>Two-Way ANOVA without replication</u><a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6801/#q11.-two-way-anova-without-replication" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<ul>
<li><strong>Read libraries &amp; data</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="http://localhost:6801/#cb94-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"student.xlsx"</span>)</span>
<span id="cb94-2"><a href="http://localhost:6801/#cb94-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Students <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>Students)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><strong>Perform a Two-Way ANOVA</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="http://localhost:6801/#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-way ANOVA without replication</span></span>
<span id="cb95-2"><a href="http://localhost:6801/#cb95-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(score <span class="sc">~</span> Subject, <span class="at">data =</span> data)</span>
<span id="cb95-3"><a href="http://localhost:6801/#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Subject      3   1572   524.0    7.09 0.000875 ***
Residuals   32   2365    73.9                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="http://localhost:6801/#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-way ANOVA with replication</span></span>
<span id="cb97-2"><a href="http://localhost:6801/#cb97-2" aria-hidden="true" tabindex="-1"></a>anova_result2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(score <span class="sc">~</span> Subject <span class="sc">+</span> Students, <span class="at">data=</span>data)</span>
<span id="cb97-3"><a href="http://localhost:6801/#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Subject      3   1572   524.0   9.622 0.000235 ***
Students     8   1058   132.3   2.429 0.044270 *  
Residuals   24   1307    54.5                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="http://localhost:6801/#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Post hoc analysis using Tukeys HSD without replication</span></span>
<span id="cb99-2"><a href="http://localhost:6801/#cb99-2" aria-hidden="true" tabindex="-1"></a>tukey_posthoc <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb99-3"><a href="http://localhost:6801/#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tukey_posthoc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = score ~ Subject, data = data)

$Subject
                      diff         lwr       upr     p adj
Reading-Math     -3.555556 -14.5352715  7.424160 0.8164830
Science-Math    -17.666667 -28.6463827 -6.686951 0.0006975
Socal-Math       -6.888889 -17.8686049  4.090827 0.3403781
Science-Reading -14.111111 -25.0908271 -3.131395 0.0075835
Socal-Reading    -3.333333 -14.3130493  7.646383 0.8433778
Socal-Science    10.777778  -0.2019382 21.757494 0.0558951</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="http://localhost:6801/#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_posthoc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="http://localhost:6801/#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Post hoc with replication</span></span>
<span id="cb102-2"><a href="http://localhost:6801/#cb102-2" aria-hidden="true" tabindex="-1"></a>tukey_posthoc1 <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result2)</span>
<span id="cb102-3"><a href="http://localhost:6801/#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tukey_posthoc1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = score ~ Subject + Students, data = data)

$Subject
                      diff        lwr       upr     p adj
Reading-Math     -3.555556 -13.151718  6.040606 0.7383019
Science-Math    -17.666667 -27.262829 -8.070505 0.0001883
Socal-Math       -6.888889 -16.485051  2.707273 0.2231508
Science-Reading -14.111111 -23.707273 -4.514949 0.0024107
Socal-Reading    -3.333333 -12.929495  6.262829 0.7739648
Socal-Science    10.777778   1.181616 20.373940 0.0236680

$Students
      diff        lwr        upr     p adj
2-1  -5.75 -23.485696 11.9856963 0.9682922
3-1 -10.25 -27.985696  7.4856963 0.5798740
4-1  -9.50 -27.235696  8.2356963 0.6691814
5-1 -18.25 -35.985696 -0.5143037 0.0403442
6-1  -8.50 -26.235696  9.2356963 0.7803218
7-1 -15.75 -33.485696  1.9856963 0.1099837
8-1 -10.50 -28.235696  7.2356963 0.5499670
9-1 -16.75 -34.485696  0.9856963 0.0745922
3-2  -4.50 -22.235696 13.2356963 0.9930602
4-2  -3.75 -21.485696 13.9856963 0.9979804
5-2 -12.50 -30.235696  5.2356963 0.3300892
6-2  -2.75 -20.485696 14.9856963 0.9997844
7-2 -10.00 -27.735696  7.7356963 0.6098328
8-2  -4.75 -22.485696 12.9856963 0.9901458
9-2 -11.00 -28.735696  6.7356963 0.4909754
4-3   0.75 -16.985696 18.4856963 1.0000000
5-3  -8.00 -25.735696  9.7356963 0.8292324
6-3   1.75 -15.985696 19.4856963 0.9999931
7-3  -5.50 -23.235696 12.2356963 0.9755794
8-3  -0.25 -17.985696 17.4856963 1.0000000
9-3  -6.50 -24.235696 11.2356963 0.9373323
5-4  -8.75 -26.485696  8.9856963 0.7539477
6-4   1.00 -16.735696 18.7356963 0.9999999
7-4  -6.25 -23.985696 11.4856963 0.9492726
8-4  -1.00 -18.735696 16.7356963 0.9999999
9-4  -7.25 -24.985696 10.4856963 0.8910627
6-5   9.75  -7.985696 27.4856963 0.6396641
7-5   2.50 -15.235696 20.2356963 0.9998942
8-5   7.75  -9.985696 25.4856963 0.8514871
9-5   1.50 -16.235696 19.2356963 0.9999979
7-6  -7.25 -24.985696 10.4856963 0.8910627
8-6  -2.00 -19.735696 15.7356963 0.9999806
9-6  -8.25 -25.985696  9.4856963 0.8054670
8-7   5.25 -12.485696 22.9856963 0.9815545
9-7  -1.00 -18.735696 16.7356963 0.9999999
9-8  -6.25 -23.985696 11.4856963 0.9492726</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="http://localhost:6801/#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_posthoc1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-23-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-23-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><strong>Interpretation</strong></li>
</ul>
<p>According to the results of the post-HOC test, significant differences can be observed between different groups: <code>Science-Math</code> group had significant differences (p-value = 0.0006975 &lt; 0.05), as did the <code>Science-Reading</code> group (p-value = 0.0075835 &lt; 0.05). From the results of the ANOVA with replication we can confirm the significant differences between the 2 groups but also add that there is a difference with the <code>Social-Science</code> group (p-value = 0.0236680 &lt; 0.05) and also between the groups of students <code>5-1</code> (p-value = 0.0403442 &lt; 0.05), this model gives us more details on the results of the statistical significance.</p>
<ul>
<li><strong>ANOVA without replication</strong></li>
</ul>
<p>The ANOVA without replication is useful when we have a group and the measurement is based on one condition and we can only test it once (independent sample), as in this case. This model compares the means between the groups to determine the significant values.&nbsp;</p>
<ul>
<li><strong>ANOVA with replication</strong></li>
</ul>
<p>In the case of an ANOVA with replication, there are two independent variables, in this case Student &amp; Subjects, which makes it possible to analyse several combinations between these two factors. Having multiple observations within each combination allows a more reliable assessment of the effects of each factor and the interactions between them. As we can see from the results, replication allows the statistical power of the test to be more accurate, thus increasing confidence in the results relating to the effect of each variable and their potential interaction.</p>
<div style="page-break-after: always;"></div>
</section>
<section id="q12.-two-way-anova-with-replication" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="q12.-two-way-anova-with-replication"><span class="header-section-number">2.7</span> Q12. <u>Two-Way ANOVA with replication</u><a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:6801/#q12.-two-way-anova-with-replication" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<ul>
<li><strong>Read the data &amp; Load libraries</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="http://localhost:6801/#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading required libraries</span></span>
<span id="cb105-2"><a href="http://localhost:6801/#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb105-3"><a href="http://localhost:6801/#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb105-4"><a href="http://localhost:6801/#cb105-4" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"blood_measure.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><strong>Two way ANOVA</strong></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="http://localhost:6801/#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-way ANOVA for measure</span></span>
<span id="cb106-2"><a href="http://localhost:6801/#cb106-2" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(measure <span class="sc">~</span> sex <span class="sc">*</span> age, <span class="at">data =</span> data1)</span>
<span id="cb106-3"><a href="http://localhost:6801/#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value  Pr(&gt;F)    
sex          1  16.08   16.08   4.038  0.0550 .  
age          1  38.96   38.96   9.786  0.0043 ** 
sex:age      1  89.61   89.61  22.509 6.6e-05 ***
Residuals   26 103.51    3.98                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="http://localhost:6801/#cb108-1" aria-hidden="true" tabindex="-1"></a>posthoc <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result, <span class="at">which =</span> <span class="st">"age"</span>)</span>
<span id="cb108-2"><a href="http://localhost:6801/#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(posthoc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="http://localhost:6801/#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Post hoc analysis</span></span>
<span id="cb109-2"><a href="http://localhost:6801/#cb109-2" aria-hidden="true" tabindex="-1"></a>tukey_result <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb109-3"><a href="http://localhost:6801/#cb109-3" aria-hidden="true" tabindex="-1"></a>tukey_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = measure ~ sex * age, data = data1)

$sex
         diff       lwr        upr     p adj
M-F -1.519139 -3.073025 0.03474709 0.0549625

$age
              diff       lwr        upr     p adj
young-old -2.31785 -3.846349 -0.7893498 0.0044215

$`sex:age`
                      diff        lwr        upr     p adj
M:old-F:old      2.8971429 -0.3079526  6.1022384 0.0869856
F:young-F:old    2.1733333 -1.1411824  5.4878491 0.2966111
M:young-F:old   -2.2183333 -5.1319553  0.6952887 0.1832890
F:young-M:old   -0.7238095 -3.7691188  2.3214997 0.9138789
M:young-M:old   -5.1154762 -7.7187601 -2.5121923 0.0000676
M:young-F:young -4.3916667 -7.1285380 -1.6547953 0.0008841</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="http://localhost:6801/#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-25-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-25-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="./Assignment 3_ Uzan Valentin - Fall 2023_files/unnamed-chunk-25-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><strong>Interpretation</strong></li>
</ul>
<p>According to the summary of the two-way ANOVA, <code>age</code> has a significant impact (p-value &lt; 0.05) on <code>blood_measurement</code>, whereas <code>sex</code> does not appear to have any. The <code>age:sex</code> interraction is significant (p-value &lt; 0.05), thus showing that sex has an impact on blood measurement with age. As shown by the Tukey results, there are significant differences between <code>M:young-F:young</code> (p-value = 0.0008841 &lt; 0.05) et <code>M:young-M:old</code> (p-value = 0.0000676 &lt; 0.05)</p>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb112" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb112-1"><a href="http://localhost:6801/#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb112-2"><a href="http://localhost:6801/#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Assignment 3: Uzan Valentin - Fall 2023"</span></span>
<span id="cb112-3"><a href="http://localhost:6801/#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "11/8/2023"</span></span>
<span id="cb112-4"><a href="http://localhost:6801/#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb112-5"><a href="http://localhost:6801/#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb112-6"><a href="http://localhost:6801/#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: darkly</span></span>
<span id="cb112-7"><a href="http://localhost:6801/#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb112-8"><a href="http://localhost:6801/#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb112-9"><a href="http://localhost:6801/#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb112-10"><a href="http://localhost:6801/#cb112-10" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: github </span></span>
<span id="cb112-11"><a href="http://localhost:6801/#cb112-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb112-12"><a href="http://localhost:6801/#cb112-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-download: true</span></span>
<span id="cb112-13"><a href="http://localhost:6801/#cb112-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb112-14"><a href="http://localhost:6801/#cb112-14" aria-hidden="true" tabindex="-1"></a><span class="co">    scroll-behavior: smooth</span></span>
<span id="cb112-15"><a href="http://localhost:6801/#cb112-15" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb112-16"><a href="http://localhost:6801/#cb112-16" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb112-17"><a href="http://localhost:6801/#cb112-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb112-18"><a href="http://localhost:6801/#cb112-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-19"><a href="http://localhost:6801/#cb112-19" aria-hidden="true" tabindex="-1"></a><span class="fu"># [GLM]{.underline}</span></span>
<span id="cb112-20"><a href="http://localhost:6801/#cb112-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-21"><a href="http://localhost:6801/#cb112-21" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q1. Exploratory analysis of the variables</span></span>
<span id="cb112-22"><a href="http://localhost:6801/#cb112-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-23"><a href="http://localhost:6801/#cb112-23" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Library &amp; read the data**</span>
<span id="cb112-24"><a href="http://localhost:6801/#cb112-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-27"><a href="http://localhost:6801/#cb112-27" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-28"><a href="http://localhost:6801/#cb112-28" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/uzanv/OneDrive/Documents/Asssignement_1"</span>)</span>
<span id="cb112-29"><a href="http://localhost:6801/#cb112-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb112-30"><a href="http://localhost:6801/#cb112-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb112-31"><a href="http://localhost:6801/#cb112-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb112-32"><a href="http://localhost:6801/#cb112-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb112-33"><a href="http://localhost:6801/#cb112-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gplots)</span>
<span id="cb112-34"><a href="http://localhost:6801/#cb112-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb112-35"><a href="http://localhost:6801/#cb112-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb112-36"><a href="http://localhost:6801/#cb112-36" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb112-37"><a href="http://localhost:6801/#cb112-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb112-38"><a href="http://localhost:6801/#cb112-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb112-39"><a href="http://localhost:6801/#cb112-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-40"><a href="http://localhost:6801/#cb112-40" aria-hidden="true" tabindex="-1"></a>sticklebacks <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"sticklebacks.csv"</span>)</span>
<span id="cb112-41"><a href="http://localhost:6801/#cb112-41" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-42"><a href="http://localhost:6801/#cb112-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-43"><a href="http://localhost:6801/#cb112-43" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Bar Plots**</span>
<span id="cb112-44"><a href="http://localhost:6801/#cb112-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-47"><a href="http://localhost:6801/#cb112-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-48"><a href="http://localhost:6801/#cb112-48" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Exploration of Qualitative (categorical) variables </span></span>
<span id="cb112-49"><a href="http://localhost:6801/#cb112-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-50"><a href="http://localhost:6801/#cb112-50" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sticklebacks, <span class="fu">aes</span>(<span class="at">x=</span> presence)) <span class="sc">+</span> </span>
<span id="cb112-51"><a href="http://localhost:6801/#cb112-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"salmon"</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb112-52"><a href="http://localhost:6801/#cb112-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Barplot of Presence"</span>)</span>
<span id="cb112-53"><a href="http://localhost:6801/#cb112-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-54"><a href="http://localhost:6801/#cb112-54" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sticklebacks, <span class="fu">aes</span>(<span class="at">x=</span> fowl)) <span class="sc">+</span> </span>
<span id="cb112-55"><a href="http://localhost:6801/#cb112-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"salmon"</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb112-56"><a href="http://localhost:6801/#cb112-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Barplot of fowl"</span>)</span>
<span id="cb112-57"><a href="http://localhost:6801/#cb112-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-58"><a href="http://localhost:6801/#cb112-58" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sticklebacks, <span class="fu">aes</span>(<span class="at">x=</span> pred)) <span class="sc">+</span> </span>
<span id="cb112-59"><a href="http://localhost:6801/#cb112-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"salmon"</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb112-60"><a href="http://localhost:6801/#cb112-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Barplot of pred"</span>)</span>
<span id="cb112-61"><a href="http://localhost:6801/#cb112-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-62"><a href="http://localhost:6801/#cb112-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-63"><a href="http://localhost:6801/#cb112-63" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Linear Model &amp; VIF**</span>
<span id="cb112-64"><a href="http://localhost:6801/#cb112-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-67"><a href="http://localhost:6801/#cb112-67" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-68"><a href="http://localhost:6801/#cb112-68" aria-hidden="true" tabindex="-1"></a><span class="co">#linear model</span></span>
<span id="cb112-69"><a href="http://localhost:6801/#cb112-69" aria-hidden="true" tabindex="-1"></a>model_st <span class="ot">&lt;-</span> <span class="fu">glm</span>(presence <span class="sc">~</span> area <span class="sc">+</span> dry <span class="sc">+</span> nutr <span class="sc">+</span> veg <span class="sc">+</span> fowl <span class="sc">+</span> pred <span class="sc">+</span> ponds <span class="sc">+</span> land <span class="sc">+</span> macro <span class="sc">+</span> HS, <span class="at">data =</span> sticklebacks)</span>
<span id="cb112-70"><a href="http://localhost:6801/#cb112-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-71"><a href="http://localhost:6801/#cb112-71" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_st)</span>
<span id="cb112-72"><a href="http://localhost:6801/#cb112-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-73"><a href="http://localhost:6801/#cb112-73" aria-hidden="true" tabindex="-1"></a><span class="co"># VIF</span></span>
<span id="cb112-74"><a href="http://localhost:6801/#cb112-74" aria-hidden="true" tabindex="-1"></a>vif_model_st <span class="ot">&lt;-</span> <span class="fu">vif</span>(model_st)</span>
<span id="cb112-75"><a href="http://localhost:6801/#cb112-75" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(vif_model_st)</span>
<span id="cb112-76"><a href="http://localhost:6801/#cb112-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-77"><a href="http://localhost:6801/#cb112-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-78"><a href="http://localhost:6801/#cb112-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-79"><a href="http://localhost:6801/#cb112-79" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**PCA**</span>
<span id="cb112-80"><a href="http://localhost:6801/#cb112-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-83"><a href="http://localhost:6801/#cb112-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-84"><a href="http://localhost:6801/#cb112-84" aria-hidden="true" tabindex="-1"></a><span class="co"># -- PCA</span></span>
<span id="cb112-85"><a href="http://localhost:6801/#cb112-85" aria-hidden="true" tabindex="-1"></a>sticklebacks_std <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(sticklebacks))</span>
<span id="cb112-86"><a href="http://localhost:6801/#cb112-86" aria-hidden="true" tabindex="-1"></a>pca_results <span class="ot">&lt;-</span> <span class="fu">PCA</span>(sticklebacks_std)</span>
<span id="cb112-87"><a href="http://localhost:6801/#cb112-87" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_biplot</span>(pca_results, </span>
<span id="cb112-88"><a href="http://localhost:6801/#cb112-88" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom.ind =</span> <span class="st">"point"</span>, </span>
<span id="cb112-89"><a href="http://localhost:6801/#cb112-89" aria-hidden="true" tabindex="-1"></a>                <span class="at">geom.var =</span> <span class="st">"arrow"</span>,</span>
<span id="cb112-90"><a href="http://localhost:6801/#cb112-90" aria-hidden="true" tabindex="-1"></a>                <span class="at">col.ind =</span> <span class="st">"blue"</span>, </span>
<span id="cb112-91"><a href="http://localhost:6801/#cb112-91" aria-hidden="true" tabindex="-1"></a>                <span class="at">col.var =</span> <span class="st">"red"</span>)</span>
<span id="cb112-92"><a href="http://localhost:6801/#cb112-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-93"><a href="http://localhost:6801/#cb112-93" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(pca_results)</span>
<span id="cb112-94"><a href="http://localhost:6801/#cb112-94" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-95"><a href="http://localhost:6801/#cb112-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-96"><a href="http://localhost:6801/#cb112-96" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Pearson Correlation Heatmap**</span>
<span id="cb112-97"><a href="http://localhost:6801/#cb112-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-100"><a href="http://localhost:6801/#cb112-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-101"><a href="http://localhost:6801/#cb112-101" aria-hidden="true" tabindex="-1"></a><span class="co"># -- Correlation matrix for continuous variables</span></span>
<span id="cb112-102"><a href="http://localhost:6801/#cb112-102" aria-hidden="true" tabindex="-1"></a>continuous <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"HS"</span>, <span class="st">"ponds"</span>, <span class="st">"area"</span>, <span class="st">"dry"</span>, <span class="st">"nutr"</span>, <span class="st">"veg"</span>, <span class="st">"macro"</span>)</span>
<span id="cb112-103"><a href="http://localhost:6801/#cb112-103" aria-hidden="true" tabindex="-1"></a>sticklebacks[continuous] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(sticklebacks[continuous], as.numeric)</span>
<span id="cb112-104"><a href="http://localhost:6801/#cb112-104" aria-hidden="true" tabindex="-1"></a>cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(sticklebacks[continuous], <span class="at">use =</span> <span class="st">"complete.obs"</span>)  </span>
<span id="cb112-105"><a href="http://localhost:6801/#cb112-105" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap.2</span>(cor,</span>
<span id="cb112-106"><a href="http://localhost:6801/#cb112-106" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Pearson Correlation Heatmap"</span>,</span>
<span id="cb112-107"><a href="http://localhost:6801/#cb112-107" aria-hidden="true" tabindex="-1"></a>          <span class="at">density.info =</span> <span class="st">"none"</span>,</span>
<span id="cb112-108"><a href="http://localhost:6801/#cb112-108" aria-hidden="true" tabindex="-1"></a>          <span class="at">trace =</span> <span class="st">"none"</span>,</span>
<span id="cb112-109"><a href="http://localhost:6801/#cb112-109" aria-hidden="true" tabindex="-1"></a>          <span class="at">margins =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">8</span>),</span>
<span id="cb112-110"><a href="http://localhost:6801/#cb112-110" aria-hidden="true" tabindex="-1"></a>          <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"red"</span>))(<span class="dv">50</span>),</span>
<span id="cb112-111"><a href="http://localhost:6801/#cb112-111" aria-hidden="true" tabindex="-1"></a>          <span class="at">cexRow =</span> <span class="fl">0.7</span>, </span>
<span id="cb112-112"><a href="http://localhost:6801/#cb112-112" aria-hidden="true" tabindex="-1"></a>          <span class="at">cexCol =</span> <span class="fl">0.7</span>,</span>
<span id="cb112-113"><a href="http://localhost:6801/#cb112-113" aria-hidden="true" tabindex="-1"></a>          <span class="at">dendrogram =</span> <span class="st">"both"</span>, </span>
<span id="cb112-114"><a href="http://localhost:6801/#cb112-114" aria-hidden="true" tabindex="-1"></a>          <span class="at">Rowv =</span> <span class="cn">TRUE</span>,        </span>
<span id="cb112-115"><a href="http://localhost:6801/#cb112-115" aria-hidden="true" tabindex="-1"></a>          <span class="at">Colv =</span> <span class="cn">TRUE</span>,        </span>
<span id="cb112-116"><a href="http://localhost:6801/#cb112-116" aria-hidden="true" tabindex="-1"></a>          <span class="at">cellnote =</span> <span class="fu">round</span>(cor, <span class="dv">2</span>), </span>
<span id="cb112-117"><a href="http://localhost:6801/#cb112-117" aria-hidden="true" tabindex="-1"></a>          <span class="at">notecol =</span> <span class="st">"black"</span></span>
<span id="cb112-118"><a href="http://localhost:6801/#cb112-118" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb112-119"><a href="http://localhost:6801/#cb112-119" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-120"><a href="http://localhost:6801/#cb112-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-121"><a href="http://localhost:6801/#cb112-121" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Interpretation**</span>
<span id="cb112-122"><a href="http://localhost:6801/#cb112-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-123"><a href="http://localhost:6801/#cb112-123" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Linear Model &amp; VIF**</span>
<span id="cb112-124"><a href="http://localhost:6801/#cb112-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-125"><a href="http://localhost:6801/#cb112-125" aria-hidden="true" tabindex="-1"></a>From the linear model, we can see that certain factors have a significant impact on the presence of stick, notably the variables <span class="in">`dry`</span> (p-value = 0.045678 <span class="sc">\&lt;</span> 0.05) <span class="in">`land`</span> (p-value = 0.033085 <span class="sc">\&lt;</span> 0.05) and <span class="in">`HS`</span> (p-value = 0.000621<span class="sc">\&lt;</span> 0.05), HS being the predictor with the greatest influence on presence, while <span class="in">`dry`</span> and <span class="in">`land`</span> are close to the threshold. Thus removing <span class="in">`HS`</span> seems to be a good thing but we should do the same for 'dry and land' in order to avoid interractions in our model should be a good thing, but we will confirm this hypothesis during the AIC step. Note that the starting AIC for this model is given as **243.98**.</span>
<span id="cb112-126"><a href="http://localhost:6801/#cb112-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-127"><a href="http://localhost:6801/#cb112-127" aria-hidden="true" tabindex="-1"></a>Furthermore, in the VIF results, there are no VIF values <span class="sc">\&gt;</span>10 indicating multicollinearity, but we can see that the <span class="in">`HS`</span> value is relatively high compared with the others (around 1.7 on average compared with 6.1 for <span class="in">`HS`</span>), indicating that this variable should be taken into consideration.</span>
<span id="cb112-128"><a href="http://localhost:6801/#cb112-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-129"><a href="http://localhost:6801/#cb112-129" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**PCA**</span>
<span id="cb112-130"><a href="http://localhost:6801/#cb112-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-131"><a href="http://localhost:6801/#cb112-131" aria-hidden="true" tabindex="-1"></a>Based on the results of the PCA plots, hypotheses can be made about the variables that could influence the model. Variables with the same relatively close direction, such as <span class="in">`HS`</span> and <span class="in">`macro`</span>, can interfere with the model, but as <span class="in">`HS`</span> is a variable that combines with the other factors, we can remove it from the model since it will interact with our variables a fortciori. As the power of magnitude fluctuates between the variables but is not significantly low or too high, we will consider all the variables in our first model and carry out an AIC to confirm the hypotheses issued.</span>
<span id="cb112-132"><a href="http://localhost:6801/#cb112-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-133"><a href="http://localhost:6801/#cb112-133" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Correlation**</span>
<span id="cb112-134"><a href="http://localhost:6801/#cb112-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-135"><a href="http://localhost:6801/#cb112-135" aria-hidden="true" tabindex="-1"></a>According to the Heat map, the <span class="in">`HS`</span> variable appears to have a strong to moderate positive correlation with <span class="in">`macro`</span> (0.56), <span class="in">`nutr`</span> (0.49) and <span class="in">`ponds`</span> (0.34) variables, and also a negative correlation with <span class="in">`veg`</span> (-0.44) and <span class="in">`dry`</span> (-0.42), showing that this variable is likely to influence our model as previously postulated. Certain other variables appear to have moderate positive or negative correlations with each other, such as <span class="in">`macro-veg`</span> (-0.33), <span class="in">`macro-nutr`</span> (0.26) or <span class="in">`area-dry`</span> (-0.27).</span>
<span id="cb112-136"><a href="http://localhost:6801/#cb112-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-137"><a href="http://localhost:6801/#cb112-137" aria-hidden="true" tabindex="-1"></a>In conclusion, certain variables, in particular <span class="in">`HS`</span>, which should be removed from the model, but also <span class="in">`dry`</span>, <span class="in">`land`</span> and potentially <span class="in">`macro`</span> variables, should be considered as potential predictive factors for making interactions.</span>
<span id="cb112-138"><a href="http://localhost:6801/#cb112-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-139"><a href="http://localhost:6801/#cb112-139" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb112-140"><a href="http://localhost:6801/#cb112-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-141"><a href="http://localhost:6801/#cb112-141" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q2. Binomial model building</span></span>
<span id="cb112-142"><a href="http://localhost:6801/#cb112-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-143"><a href="http://localhost:6801/#cb112-143" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Read &amp; Library**</span>
<span id="cb112-144"><a href="http://localhost:6801/#cb112-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-147"><a href="http://localhost:6801/#cb112-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-148"><a href="http://localhost:6801/#cb112-148" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb112-149"><a href="http://localhost:6801/#cb112-149" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb112-150"><a href="http://localhost:6801/#cb112-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-151"><a href="http://localhost:6801/#cb112-151" aria-hidden="true" tabindex="-1"></a>sticklebacks<span class="sc">$</span>dry <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sticklebacks<span class="sc">$</span>dry)</span>
<span id="cb112-152"><a href="http://localhost:6801/#cb112-152" aria-hidden="true" tabindex="-1"></a>sticklebacks<span class="sc">$</span>nutr <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sticklebacks<span class="sc">$</span>nutr)</span>
<span id="cb112-153"><a href="http://localhost:6801/#cb112-153" aria-hidden="true" tabindex="-1"></a>sticklebacks<span class="sc">$</span>land <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sticklebacks<span class="sc">$</span>land)</span>
<span id="cb112-154"><a href="http://localhost:6801/#cb112-154" aria-hidden="true" tabindex="-1"></a>sticklebacks<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sticklebacks<span class="sc">$</span>pred)</span>
<span id="cb112-155"><a href="http://localhost:6801/#cb112-155" aria-hidden="true" tabindex="-1"></a>sticklebacks<span class="sc">$</span>fowl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(sticklebacks<span class="sc">$</span>fowl)</span>
<span id="cb112-156"><a href="http://localhost:6801/#cb112-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-157"><a href="http://localhost:6801/#cb112-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-160"><a href="http://localhost:6801/#cb112-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-161"><a href="http://localhost:6801/#cb112-161" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the binomial model</span></span>
<span id="cb112-162"><a href="http://localhost:6801/#cb112-162" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(presence <span class="sc">~</span> area <span class="sc">+</span> dry <span class="sc">+</span> nutr <span class="sc">+</span> veg <span class="sc">+</span> fowl <span class="sc">+</span> pred <span class="sc">+</span> ponds <span class="sc">+</span> land <span class="sc">+</span> macro, </span>
<span id="cb112-163"><a href="http://localhost:6801/#cb112-163" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> sticklebacks, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb112-164"><a href="http://localhost:6801/#cb112-164" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the model</span></span>
<span id="cb112-165"><a href="http://localhost:6801/#cb112-165" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb112-166"><a href="http://localhost:6801/#cb112-166" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the model's coefficients to a tidy dataframe</span></span>
<span id="cb112-167"><a href="http://localhost:6801/#cb112-167" aria-hidden="true" tabindex="-1"></a>tidy_model <span class="ot">&lt;-</span> <span class="fu">tidy</span>(model)</span>
<span id="cb112-168"><a href="http://localhost:6801/#cb112-168" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the coefficient plot</span></span>
<span id="cb112-169"><a href="http://localhost:6801/#cb112-169" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tidy_model, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> <span class="fu">reorder</span>(term, estimate), <span class="at">xmin =</span> estimate <span class="sc">-</span> std.error <span class="sc">*</span> <span class="fl">1.96</span>, <span class="at">xmax =</span> estimate <span class="sc">+</span> std.error <span class="sc">*</span> <span class="fl">1.96</span>)) <span class="sc">+</span></span>
<span id="cb112-170"><a href="http://localhost:6801/#cb112-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span>  </span>
<span id="cb112-171"><a href="http://localhost:6801/#cb112-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb112-172"><a href="http://localhost:6801/#cb112-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="at">height =</span> <span class="fl">0.1</span>) <span class="sc">+</span>  </span>
<span id="cb112-173"><a href="http://localhost:6801/#cb112-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Coefficient Plot for Sticklebacks Model"</span>, <span class="at">x =</span> <span class="st">"Coefficient Estimate"</span>, <span class="at">y =</span> <span class="st">"Predictors"</span>) <span class="sc">+</span></span>
<span id="cb112-174"><a href="http://localhost:6801/#cb112-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb112-175"><a href="http://localhost:6801/#cb112-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-176"><a href="http://localhost:6801/#cb112-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-177"><a href="http://localhost:6801/#cb112-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-178"><a href="http://localhost:6801/#cb112-178" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Interpretation**</span>
<span id="cb112-179"><a href="http://localhost:6801/#cb112-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-180"><a href="http://localhost:6801/#cb112-180" aria-hidden="true" tabindex="-1"></a>The model summary indicates an interaction with the variables <span class="in">`nutr`</span>, <span class="in">`ponds`</span> and <span class="in">`macro`</span> as positive predictors with a statistically significant association (p-value <span class="sc">\&lt;</span>0.05) with the presence of sticklebacks.</span>
<span id="cb112-181"><a href="http://localhost:6801/#cb112-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-182"><a href="http://localhost:6801/#cb112-182" aria-hidden="true" tabindex="-1"></a>Conversely, vegetation <span class="in">`veg`</span> appeared as a negative predictor, indicating that denser vegetation might discourage the presence of sticklebacks. The fit of the model, indicated by a substantial reduction in deviance and a relatively low AIC, suggests that these variables together provide a significant explanation of the data.</span>
<span id="cb112-183"><a href="http://localhost:6801/#cb112-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-184"><a href="http://localhost:6801/#cb112-184" aria-hidden="true" tabindex="-1"></a>The graph confirms the results obtained in the summary, particularly for the positive influence of the predictors <span class="in">`nutr`</span>, <span class="in">`ponds`</span> and <span class="in">`macro`</span> , but the model also shows us that the <span class="in">`pred`</span> variable stands out with a negative coefficient, indicating a strong inverse relationship between the presence of predators and sticklebacks. Conversely, many predictor variables, such as <span class="in">`nutr`</span> and <span class="in">`fowl`</span> have confidence intervals that cross the zero line, indicating that there is no clear evidence of their impact on stickleback presence.</span>
<span id="cb112-185"><a href="http://localhost:6801/#cb112-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-186"><a href="http://localhost:6801/#cb112-186" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb112-187"><a href="http://localhost:6801/#cb112-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-188"><a href="http://localhost:6801/#cb112-188" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q3. Model Selection</span></span>
<span id="cb112-189"><a href="http://localhost:6801/#cb112-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-192"><a href="http://localhost:6801/#cb112-192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-193"><a href="http://localhost:6801/#cb112-193" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(presence <span class="sc">~</span> area <span class="sc">+</span> dry <span class="sc">+</span> nutr <span class="sc">+</span> veg <span class="sc">+</span> fowl <span class="sc">+</span> pred <span class="sc">+</span> ponds <span class="sc">+</span> land <span class="sc">+</span> macro,</span>
<span id="cb112-194"><a href="http://localhost:6801/#cb112-194" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> sticklebacks, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb112-195"><a href="http://localhost:6801/#cb112-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-196"><a href="http://localhost:6801/#cb112-196" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Remove the predictor with the highest p-value (provided it's greater than a threshold, say 0.05)</span></span>
<span id="cb112-197"><a href="http://localhost:6801/#cb112-197" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">step</span>(model1, <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">trace =</span> <span class="dv">1</span>)</span>
<span id="cb112-198"><a href="http://localhost:6801/#cb112-198" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the final model summary</span></span>
<span id="cb112-199"><a href="http://localhost:6801/#cb112-199" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span>
<span id="cb112-200"><a href="http://localhost:6801/#cb112-200" aria-hidden="true" tabindex="-1"></a>tidy_model2 <span class="ot">&lt;-</span> <span class="fu">tidy</span>(model2)</span>
<span id="cb112-201"><a href="http://localhost:6801/#cb112-201" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the coefficient plot for the reduced model</span></span>
<span id="cb112-202"><a href="http://localhost:6801/#cb112-202" aria-hidden="true" tabindex="-1"></a>tidy_model2<span class="sc">$</span>significant <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(tidy_model2<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>, <span class="st">"Significant"</span>, <span class="st">"Not Significant"</span>)</span>
<span id="cb112-203"><a href="http://localhost:6801/#cb112-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-204"><a href="http://localhost:6801/#cb112-204" aria-hidden="true" tabindex="-1"></a><span class="co"># Enhanced plot</span></span>
<span id="cb112-205"><a href="http://localhost:6801/#cb112-205" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tidy_model2, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> <span class="fu">reorder</span>(term, estimate), <span class="at">xmin =</span> estimate <span class="sc">-</span> std.error <span class="sc">*</span> <span class="fl">1.96</span>, <span class="at">xmax =</span> estimate <span class="sc">+</span> std.error <span class="sc">*</span> <span class="fl">1.96</span>)) <span class="sc">+</span></span>
<span id="cb112-206"><a href="http://localhost:6801/#cb112-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"gray80"</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb112-207"><a href="http://localhost:6801/#cb112-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size =</span> <span class="fu">abs</span>(estimate), <span class="at">color =</span> significant)) <span class="sc">+</span></span>
<span id="cb112-208"><a href="http://localhost:6801/#cb112-208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="fu">aes</span>(<span class="at">color =</span> significant), <span class="at">height =</span> <span class="fl">0.1</span>) <span class="sc">+</span>  </span>
<span id="cb112-209"><a href="http://localhost:6801/#cb112-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Significant"</span> <span class="ot">=</span> <span class="st">"darkblue"</span>, <span class="st">"Not Significant"</span> <span class="ot">=</span> <span class="st">"darkred"</span>)) <span class="sc">+</span></span>
<span id="cb112-210"><a href="http://localhost:6801/#cb112-210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb112-211"><a href="http://localhost:6801/#cb112-211" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Effects of Predictors on Presence of Sticklebacks"</span>,</span>
<span id="cb112-212"><a href="http://localhost:6801/#cb112-212" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Points represent coefficient estimates. Colors denote significance at 0.05 level."</span>,</span>
<span id="cb112-213"><a href="http://localhost:6801/#cb112-213" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Coefficient Estimate"</span>, </span>
<span id="cb112-214"><a href="http://localhost:6801/#cb112-214" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Predictors"</span>,</span>
<span id="cb112-215"><a href="http://localhost:6801/#cb112-215" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Significance"</span></span>
<span id="cb112-216"><a href="http://localhost:6801/#cb112-216" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb112-217"><a href="http://localhost:6801/#cb112-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb112-218"><a href="http://localhost:6801/#cb112-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb112-219"><a href="http://localhost:6801/#cb112-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-220"><a href="http://localhost:6801/#cb112-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-221"><a href="http://localhost:6801/#cb112-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-222"><a href="http://localhost:6801/#cb112-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-223"><a href="http://localhost:6801/#cb112-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-224"><a href="http://localhost:6801/#cb112-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-225"><a href="http://localhost:6801/#cb112-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-226"><a href="http://localhost:6801/#cb112-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-227"><a href="http://localhost:6801/#cb112-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-228"><a href="http://localhost:6801/#cb112-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-229"><a href="http://localhost:6801/#cb112-229" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Interpretation**</span>
<span id="cb112-230"><a href="http://localhost:6801/#cb112-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-231"><a href="http://localhost:6801/#cb112-231" aria-hidden="true" tabindex="-1"></a>Starting with a complete model including all the predictors, the AIC is initially **239.85**, then the `dry` variable is removed first to obtain a new AIC step of **237.86**. The next steps are to consider removing <span class="in">`land`</span>, then <span class="in">`fowl`</span>, each time with a lower AIC, suggesting that these variables do not contribute significantly to the predictive ability of the model.</span>
<span id="cb112-232"><a href="http://localhost:6801/#cb112-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-233"><a href="http://localhost:6801/#cb112-233" aria-hidden="true" tabindex="-1"></a>The final model, which excludes <span class="in">`dry`</span>, <span class="in">`land`</span> and <span class="in">`fowl`</span>, achieves an AIC of **234.44**. Indicating a more sparse model while retaining significant predictor variables such as <span class="in">`area`</span>, <span class="in">`nutr`</span>, <span class="in">`veg`</span>, <span class="in">`pred,`</span> <span class="in">`ponds`</span> and <span class="in">`macro`</span>, each contributing uniquely to the probability of stickleback presence, with <span class="in">`veg,`</span> <span class="in">`nutr`</span>, <span class="in">`ponds`</span> and <span class="in">`macro`</span> remaining statistically significant. We confirm our hypothesis as to the influence of the <span class="in">`dry`</span> and <span class="in">`land`</span> variables on the impact of the model.</span>
<span id="cb112-234"><a href="http://localhost:6801/#cb112-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-235"><a href="http://localhost:6801/#cb112-235" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb112-236"><a href="http://localhost:6801/#cb112-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-237"><a href="http://localhost:6801/#cb112-237" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q4. Comparison between model</span></span>
<span id="cb112-238"><a href="http://localhost:6801/#cb112-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-241"><a href="http://localhost:6801/#cb112-241" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-242"><a href="http://localhost:6801/#cb112-242" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the HS-only model</span></span>
<span id="cb112-243"><a href="http://localhost:6801/#cb112-243" aria-hidden="true" tabindex="-1"></a>hs_model <span class="ot">&lt;-</span> <span class="fu">glm</span>(presence <span class="sc">~</span> HS, <span class="at">data =</span> sticklebacks, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb112-244"><a href="http://localhost:6801/#cb112-244" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(presence <span class="sc">~</span> area <span class="sc">+</span> dry <span class="sc">+</span> nutr <span class="sc">+</span> veg <span class="sc">+</span> fowl <span class="sc">+</span> pred <span class="sc">+</span> ponds <span class="sc">+</span> land <span class="sc">+</span> macro <span class="sc">+</span> HS, <span class="at">data =</span> sticklebacks, <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb112-245"><a href="http://localhost:6801/#cb112-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-246"><a href="http://localhost:6801/#cb112-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-249"><a href="http://localhost:6801/#cb112-249" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-250"><a href="http://localhost:6801/#cb112-250" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain AIC and BIC for both models</span></span>
<span id="cb112-251"><a href="http://localhost:6801/#cb112-251" aria-hidden="true" tabindex="-1"></a>aic_reduced <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model3)</span>
<span id="cb112-252"><a href="http://localhost:6801/#cb112-252" aria-hidden="true" tabindex="-1"></a>aic_hs <span class="ot">&lt;-</span> <span class="fu">AIC</span>(hs_model)</span>
<span id="cb112-253"><a href="http://localhost:6801/#cb112-253" aria-hidden="true" tabindex="-1"></a>bic_reduced <span class="ot">&lt;-</span> <span class="fu">BIC</span>(model3)</span>
<span id="cb112-254"><a href="http://localhost:6801/#cb112-254" aria-hidden="true" tabindex="-1"></a>bic_hs <span class="ot">&lt;-</span> <span class="fu">BIC</span>(hs_model)</span>
<span id="cb112-255"><a href="http://localhost:6801/#cb112-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-256"><a href="http://localhost:6801/#cb112-256" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood Ratio Test</span></span>
<span id="cb112-257"><a href="http://localhost:6801/#cb112-257" aria-hidden="true" tabindex="-1"></a>lrt <span class="ot">&lt;-</span> <span class="fu">anova</span>(model3, hs_model, <span class="at">test=</span><span class="st">"Chisq"</span>)</span>
<span id="cb112-258"><a href="http://localhost:6801/#cb112-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-259"><a href="http://localhost:6801/#cb112-259" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb112-260"><a href="http://localhost:6801/#cb112-260" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC for reduced model:"</span>, aic_reduced, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb112-261"><a href="http://localhost:6801/#cb112-261" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"AIC for HS-only model:"</span>, aic_hs, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb112-262"><a href="http://localhost:6801/#cb112-262" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC for reduced model:"</span>, bic_reduced, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb112-263"><a href="http://localhost:6801/#cb112-263" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"BIC for HS-only model:"</span>, bic_hs, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb112-264"><a href="http://localhost:6801/#cb112-264" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lrt)</span>
<span id="cb112-265"><a href="http://localhost:6801/#cb112-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-266"><a href="http://localhost:6801/#cb112-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-267"><a href="http://localhost:6801/#cb112-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-268"><a href="http://localhost:6801/#cb112-268" aria-hidden="true" tabindex="-1"></a>**Interpretation**</span>
<span id="cb112-269"><a href="http://localhost:6801/#cb112-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-270"><a href="http://localhost:6801/#cb112-270" aria-hidden="true" tabindex="-1"></a>The model using the full set of predictors appears to perform better than the one using only HS as a predictor of stickleback presence. This is confirmed by lower AIC (**225.7562** vs **232.6665)** and higher BIC (**262.0377** vs **239.26**) values and significantly lower residual deviance in the complex model, indicating that it provides a better fit to the data while maintaining a balance between accuracy and simplicity. The deviance analysis table confirms this by showing a statistically significant improvement in model fit when additional predictors are included in addition to the <span class="in">`HS`</span>. This confirms the <span class="in">`HS`</span> model's impact.</span>
<span id="cb112-271"><a href="http://localhost:6801/#cb112-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-272"><a href="http://localhost:6801/#cb112-272" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb112-273"><a href="http://localhost:6801/#cb112-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-274"><a href="http://localhost:6801/#cb112-274" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q5. Overdispersion</span></span>
<span id="cb112-275"><a href="http://localhost:6801/#cb112-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-276"><a href="http://localhost:6801/#cb112-276" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**What is Overdispersion ?**</span>
<span id="cb112-277"><a href="http://localhost:6801/#cb112-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-278"><a href="http://localhost:6801/#cb112-278" aria-hidden="true" tabindex="-1"></a>Overdispersion occurs in the GLM context when the variance of the response variable is greater than the mean, giving a residual difference in the fitted model that is greater than the degrees of freedom. As normal, these two factors increase at the same rate</span>
<span id="cb112-279"><a href="http://localhost:6801/#cb112-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-280"><a href="http://localhost:6801/#cb112-280" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**How do you detect it ?**</span>
<span id="cb112-281"><a href="http://localhost:6801/#cb112-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-282"><a href="http://localhost:6801/#cb112-282" aria-hidden="true" tabindex="-1"></a>We can check the ratio of residual deviance and their degrees of freedom using this code: <span class="in">`(sum(residuals(pm3, type = "pearson") ^ 2) / pm3$df.residual)`</span> or use the AER package, if the result is **Result \&gt; 1.5** then we have overdispersion.</span>
<span id="cb112-283"><a href="http://localhost:6801/#cb112-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-284"><a href="http://localhost:6801/#cb112-284" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**What can you do about it ?**</span>
<span id="cb112-285"><a href="http://localhost:6801/#cb112-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-286"><a href="http://localhost:6801/#cb112-286" aria-hidden="true" tabindex="-1"></a>To compensate for this model, we can apply a "quasi-Poisson" model. Similar but with mean and variance values: E(Yi) = μi and var(Yi) = φ μi. Thus we allow the variance to be proportional to the mean as in a standard Poisson GLM.</span>
<span id="cb112-287"><a href="http://localhost:6801/#cb112-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-288"><a href="http://localhost:6801/#cb112-288" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb112-289"><a href="http://localhost:6801/#cb112-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-290"><a href="http://localhost:6801/#cb112-290" aria-hidden="true" tabindex="-1"></a><span class="fu"># [ANCOVA]{.underline}</span></span>
<span id="cb112-291"><a href="http://localhost:6801/#cb112-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-292"><a href="http://localhost:6801/#cb112-292" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q6. ANCOVA &amp; Interpretation</span></span>
<span id="cb112-293"><a href="http://localhost:6801/#cb112-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-294"><a href="http://localhost:6801/#cb112-294" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Read Library &amp; data**</span>
<span id="cb112-295"><a href="http://localhost:6801/#cb112-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-298"><a href="http://localhost:6801/#cb112-298" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-299"><a href="http://localhost:6801/#cb112-299" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb112-300"><a href="http://localhost:6801/#cb112-300" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb112-301"><a href="http://localhost:6801/#cb112-301" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:/Users/uzanv/OneDrive/Documents/Asssignement_1"</span>)</span>
<span id="cb112-302"><a href="http://localhost:6801/#cb112-302" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"swim_speed.xlsx"</span>)</span>
<span id="cb112-303"><a href="http://localhost:6801/#cb112-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-304"><a href="http://localhost:6801/#cb112-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-305"><a href="http://localhost:6801/#cb112-305" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Perform an anova**</span>
<span id="cb112-306"><a href="http://localhost:6801/#cb112-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-309"><a href="http://localhost:6801/#cb112-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-310"><a href="http://localhost:6801/#cb112-310" aria-hidden="true" tabindex="-1"></a><span class="co"># 1st way</span></span>
<span id="cb112-311"><a href="http://localhost:6801/#cb112-311" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">aov</span>(Speed <span class="sc">~</span> Fish <span class="sc">+</span> Temp, <span class="at">data =</span> data)</span>
<span id="cb112-312"><a href="http://localhost:6801/#cb112-312" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb112-313"><a href="http://localhost:6801/#cb112-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-314"><a href="http://localhost:6801/#cb112-314" aria-hidden="true" tabindex="-1"></a><span class="co"># Visual representation of interaction (if significant)</span></span>
<span id="cb112-315"><a href="http://localhost:6801/#cb112-315" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> Speed, <span class="at">y =</span> Temp, <span class="at">color =</span> Fish)) <span class="sc">+</span> </span>
<span id="cb112-316"><a href="http://localhost:6801/#cb112-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span>  </span>
<span id="cb112-317"><a href="http://localhost:6801/#cb112-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  </span>
<span id="cb112-318"><a href="http://localhost:6801/#cb112-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Fish) <span class="sc">+</span>  </span>
<span id="cb112-319"><a href="http://localhost:6801/#cb112-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb112-320"><a href="http://localhost:6801/#cb112-320" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relationship between Speed and Temperature by Fish Type"</span>,</span>
<span id="cb112-321"><a href="http://localhost:6801/#cb112-321" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Speed"</span>,</span>
<span id="cb112-322"><a href="http://localhost:6801/#cb112-322" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Temperature"</span>,</span>
<span id="cb112-323"><a href="http://localhost:6801/#cb112-323" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Fish Type"</span></span>
<span id="cb112-324"><a href="http://localhost:6801/#cb112-324" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb112-325"><a href="http://localhost:6801/#cb112-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>  </span>
<span id="cb112-326"><a href="http://localhost:6801/#cb112-326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb112-327"><a href="http://localhost:6801/#cb112-327" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),  </span>
<span id="cb112-328"><a href="http://localhost:6801/#cb112-328" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>  </span>
<span id="cb112-329"><a href="http://localhost:6801/#cb112-329" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb112-330"><a href="http://localhost:6801/#cb112-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-331"><a href="http://localhost:6801/#cb112-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-332"><a href="http://localhost:6801/#cb112-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-333"><a href="http://localhost:6801/#cb112-333" aria-hidden="true" tabindex="-1"></a>**Interpretation**</span>
<span id="cb112-334"><a href="http://localhost:6801/#cb112-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-335"><a href="http://localhost:6801/#cb112-335" aria-hidden="true" tabindex="-1"></a>From the summary we can see that for the variables Fish and Temp both show significant effects with a p-value <span class="sc">\&lt;</span> 0.05 (alpha threshold value) of 2.10-16 indicating respectively that there are differences in speed between fish species and that <span class="in">`Temperature`</span> has an impact on speed.</span>
<span id="cb112-336"><a href="http://localhost:6801/#cb112-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-337"><a href="http://localhost:6801/#cb112-337" aria-hidden="true" tabindex="-1"></a>Furthermore, we can confirm this by the visual interpretation offered by the graph, which shows the relationship between swimming speed and water temperature for three different types of fish designated <span class="in">`ex`</span>, <span class="in">`fake`</span> and <span class="in">`niv`</span> .</span>
<span id="cb112-338"><a href="http://localhost:6801/#cb112-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-339"><a href="http://localhost:6801/#cb112-339" aria-hidden="true" tabindex="-1"></a>Each graph shows a positive correlation between temperature and speed for the type of fish concerned. The 3 species each show a distinct linear relationship, with the data points following the line showing a relatively strong and positive correlation. This means that as temperature increases, the swimming speed of each type of fish also increases. The consistency of this trend between the three types of fish suggests that temperature is a significant factor influencing swimming speed.</span>
<span id="cb112-340"><a href="http://localhost:6801/#cb112-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-341"><a href="http://localhost:6801/#cb112-341" aria-hidden="true" tabindex="-1"></a>By adding the continuous variable <span class="in">`Temperature`</span>, we used covariance to take account of how this affects the swimming speeds of the different fish by influencing water temperature.</span>
<span id="cb112-342"><a href="http://localhost:6801/#cb112-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-343"><a href="http://localhost:6801/#cb112-343" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb112-344"><a href="http://localhost:6801/#cb112-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-345"><a href="http://localhost:6801/#cb112-345" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q7. Adjusted mean</span></span>
<span id="cb112-346"><a href="http://localhost:6801/#cb112-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-347"><a href="http://localhost:6801/#cb112-347" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Read libraries &amp; data**</span>
<span id="cb112-348"><a href="http://localhost:6801/#cb112-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-351"><a href="http://localhost:6801/#cb112-351" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-352"><a href="http://localhost:6801/#cb112-352" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(phia)</span>
<span id="cb112-353"><a href="http://localhost:6801/#cb112-353" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Temp <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data<span class="sc">$</span>Temp)</span>
<span id="cb112-354"><a href="http://localhost:6801/#cb112-354" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Fish <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>Fish)</span>
<span id="cb112-355"><a href="http://localhost:6801/#cb112-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-356"><a href="http://localhost:6801/#cb112-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-357"><a href="http://localhost:6801/#cb112-357" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Perform model mean**</span>
<span id="cb112-358"><a href="http://localhost:6801/#cb112-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-361"><a href="http://localhost:6801/#cb112-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-362"><a href="http://localhost:6801/#cb112-362" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(Speed <span class="sc">~</span> Fish <span class="sc">*</span> Temp, <span class="at">data=</span>data)</span>
<span id="cb112-363"><a href="http://localhost:6801/#cb112-363" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span>
<span id="cb112-364"><a href="http://localhost:6801/#cb112-364" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">interactionMeans</span>(mod)</span>
<span id="cb112-365"><a href="http://localhost:6801/#cb112-365" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(means)</span>
<span id="cb112-366"><a href="http://localhost:6801/#cb112-366" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(means, <span class="at">abbrev.levels=</span><span class="cn">TRUE</span>)</span>
<span id="cb112-367"><a href="http://localhost:6801/#cb112-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-368"><a href="http://localhost:6801/#cb112-368" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-369"><a href="http://localhost:6801/#cb112-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-370"><a href="http://localhost:6801/#cb112-370" aria-hidden="true" tabindex="-1"></a>**Interpretation**</span>
<span id="cb112-371"><a href="http://localhost:6801/#cb112-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-372"><a href="http://localhost:6801/#cb112-372" aria-hidden="true" tabindex="-1"></a>The graph shows the average swimming speeds for three types of fish, corrected for the influence of water temperature. <span class="in">`Fake`</span> fish had the highest adjusted speed, significantly outstripping the <span class="in">`ex`</span> and <span class="in">`niv`</span> types. On the other hand, <span class="in">`ex`</span> and <span class="in">`niv`</span> fish show comparable speeds, as indicated by the overlapping confidence intervals. This visual suggests that while temperature has an overall impact on swimming speed, the <span class="in">`fake`</span> fish type appears to be the fastest when this variable is taken into account.</span>
<span id="cb112-373"><a href="http://localhost:6801/#cb112-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-374"><a href="http://localhost:6801/#cb112-374" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb112-375"><a href="http://localhost:6801/#cb112-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-376"><a href="http://localhost:6801/#cb112-376" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q8. [One-way ANOVA]{.underline}</span></span>
<span id="cb112-377"><a href="http://localhost:6801/#cb112-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-378"><a href="http://localhost:6801/#cb112-378" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Library &amp; read the data**</span>
<span id="cb112-379"><a href="http://localhost:6801/#cb112-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-382"><a href="http://localhost:6801/#cb112-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-383"><a href="http://localhost:6801/#cb112-383" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb112-384"><a href="http://localhost:6801/#cb112-384" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb112-385"><a href="http://localhost:6801/#cb112-385" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb112-386"><a href="http://localhost:6801/#cb112-386" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb112-387"><a href="http://localhost:6801/#cb112-387" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb112-388"><a href="http://localhost:6801/#cb112-388" aria-hidden="true" tabindex="-1"></a><span class="co"># Read the data</span></span>
<span id="cb112-389"><a href="http://localhost:6801/#cb112-389" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"grass.xlsx"</span>)</span>
<span id="cb112-390"><a href="http://localhost:6801/#cb112-390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-391"><a href="http://localhost:6801/#cb112-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-392"><a href="http://localhost:6801/#cb112-392" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**A. Use any informative plotting show the data - Boxplot**</span>
<span id="cb112-393"><a href="http://localhost:6801/#cb112-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-396"><a href="http://localhost:6801/#cb112-396" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-397"><a href="http://localhost:6801/#cb112-397" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>treatment)</span>
<span id="cb112-398"><a href="http://localhost:6801/#cb112-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-399"><a href="http://localhost:6801/#cb112-399" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot with jittered points</span></span>
<span id="cb112-400"><a href="http://localhost:6801/#cb112-400" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> treatment, <span class="at">y =</span> lenght, <span class="at">fill =</span> treatment)) <span class="sc">+</span></span>
<span id="cb112-401"><a href="http://localhost:6801/#cb112-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> </span>
<span id="cb112-402"><a href="http://localhost:6801/#cb112-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="fu">aes</span>(<span class="at">color =</span> treatment)) <span class="sc">+</span> </span>
<span id="cb112-403"><a href="http://localhost:6801/#cb112-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Grass Growth by Treatment"</span>, <span class="at">x =</span> <span class="st">"Treatment"</span>, <span class="at">y =</span> <span class="st">"Length (cm)"</span>) <span class="sc">+</span></span>
<span id="cb112-404"><a href="http://localhost:6801/#cb112-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb112-405"><a href="http://localhost:6801/#cb112-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-406"><a href="http://localhost:6801/#cb112-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-407"><a href="http://localhost:6801/#cb112-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-408"><a href="http://localhost:6801/#cb112-408" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**B. Perform ONE-WAY ANOVA &amp; show the result**</span>
<span id="cb112-409"><a href="http://localhost:6801/#cb112-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-412"><a href="http://localhost:6801/#cb112-412" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-413"><a href="http://localhost:6801/#cb112-413" aria-hidden="true" tabindex="-1"></a>s_anova_model <span class="ot">&lt;-</span> <span class="fu">aov</span>(lenght <span class="sc">~</span> treatment, <span class="at">data =</span> data)</span>
<span id="cb112-414"><a href="http://localhost:6801/#cb112-414" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(s_anova_model)</span>
<span id="cb112-415"><a href="http://localhost:6801/#cb112-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-416"><a href="http://localhost:6801/#cb112-416" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(lenght <span class="sc">~</span> treatment, <span class="at">data=</span>data)</span>
<span id="cb112-417"><a href="http://localhost:6801/#cb112-417" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model_lm)</span>
<span id="cb112-418"><a href="http://localhost:6801/#cb112-418" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_lm)</span>
<span id="cb112-419"><a href="http://localhost:6801/#cb112-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-420"><a href="http://localhost:6801/#cb112-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-421"><a href="http://localhost:6801/#cb112-421" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**C. Interpreation of R-Squared**</span>
<span id="cb112-422"><a href="http://localhost:6801/#cb112-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-423"><a href="http://localhost:6801/#cb112-423" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**ANOVA**</span>
<span id="cb112-424"><a href="http://localhost:6801/#cb112-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-425"><a href="http://localhost:6801/#cb112-425" aria-hidden="true" tabindex="-1"></a>        The summary shows a p-value below the 0.05 alpha threshold (1.52e-10) indicating that treatment has a significant impact on the length of the</span>
<span id="cb112-426"><a href="http://localhost:6801/#cb112-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-427"><a href="http://localhost:6801/#cb112-427" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Linear regression model**</span>
<span id="cb112-428"><a href="http://localhost:6801/#cb112-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-429"><a href="http://localhost:6801/#cb112-429" aria-hidden="true" tabindex="-1"></a>        According to the analysis of variance of the regression model, the p-value is significant p-valu <span class="sc">\&lt;</span> 0.05 confirming the result obtained with the ANOVA on the impact of treatment on length. Furthermore, according to the summary, the variables <span class="in">`treatmenttreat2`</span> (p-value = 0.000499) <span class="in">`treatmenttreat4`</span> (p-value = 1.38e-05) and <span class="in">`treatmenttreat5`</span> (best impact with a p-value = 3.78e-10) have a significant impact on length (p-value <span class="sc">\&lt;</span>0.05) whereas <span class="in">`treatmenttreat3`</span> has no effect on length (p-value <span class="sc">\&gt;</span> 0.05). The residuals appear to be well distributed and the model is therefore well centred.</span>
<span id="cb112-430"><a href="http://localhost:6801/#cb112-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-431"><a href="http://localhost:6801/#cb112-431" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**R-Squared**</span>
<span id="cb112-432"><a href="http://localhost:6801/#cb112-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-433"><a href="http://localhost:6801/#cb112-433" aria-hidden="true" tabindex="-1"></a>        The **R-Squared** obtained is 0.5182, showing that 51.82% of the variation in <span class="in">`length`</span> can be explained by differences in <span class="in">`treatment`</span>. This measure allows us to check the model's adequacy by verifying the impact of the independent <span class="in">`treatment`</span> variable on <span class="in">`length`</span>.</span>
<span id="cb112-434"><a href="http://localhost:6801/#cb112-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-435"><a href="http://localhost:6801/#cb112-435" aria-hidden="true" tabindex="-1"></a>        The **Adjusted R-squared** of 0.4907 provides a more accurate measure than the R-squared by taking into account only the number of predictors in the model.</span>
<span id="cb112-436"><a href="http://localhost:6801/#cb112-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-437"><a href="http://localhost:6801/#cb112-437" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**D. Power**</span>
<span id="cb112-438"><a href="http://localhost:6801/#cb112-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-441"><a href="http://localhost:6801/#cb112-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-442"><a href="http://localhost:6801/#cb112-442" aria-hidden="true" tabindex="-1"></a>power_result <span class="ot">&lt;-</span> <span class="fu">power.anova.test</span>(<span class="at">groups =</span> <span class="fu">length</span>(<span class="fu">unique</span>(data<span class="sc">$</span>treatment)), <span class="at">n =</span> <span class="dv">15</span>, </span>
<span id="cb112-443"><a href="http://localhost:6801/#cb112-443" aria-hidden="true" tabindex="-1"></a>                                <span class="at">between.var =</span> <span class="fl">4.723836</span>, </span>
<span id="cb112-444"><a href="http://localhost:6801/#cb112-444" aria-hidden="true" tabindex="-1"></a>                                <span class="at">within.var =</span> <span class="fl">3.763848</span>)</span>
<span id="cb112-445"><a href="http://localhost:6801/#cb112-445" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(power_result)</span>
<span id="cb112-446"><a href="http://localhost:6801/#cb112-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-447"><a href="http://localhost:6801/#cb112-447" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-448"><a href="http://localhost:6801/#cb112-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-449"><a href="http://localhost:6801/#cb112-449" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb112-450"><a href="http://localhost:6801/#cb112-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-451"><a href="http://localhost:6801/#cb112-451" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q9. [Tukey Test &amp; Fisher LSD]{.underline}</span></span>
<span id="cb112-452"><a href="http://localhost:6801/#cb112-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-455"><a href="http://localhost:6801/#cb112-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-456"><a href="http://localhost:6801/#cb112-456" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb112-457"><a href="http://localhost:6801/#cb112-457" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Anova</span></span>
<span id="cb112-458"><a href="http://localhost:6801/#cb112-458" aria-hidden="true" tabindex="-1"></a>anova_model <span class="ot">&lt;-</span> <span class="fu">aov</span>(lenght <span class="sc">~</span> treatment, <span class="at">data=</span>data)</span>
<span id="cb112-459"><a href="http://localhost:6801/#cb112-459" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_model)</span>
<span id="cb112-460"><a href="http://localhost:6801/#cb112-460" aria-hidden="true" tabindex="-1"></a>tukey_results <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_model)</span>
<span id="cb112-461"><a href="http://localhost:6801/#cb112-461" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tukey_results)</span>
<span id="cb112-462"><a href="http://localhost:6801/#cb112-462" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot </span></span>
<span id="cb112-463"><a href="http://localhost:6801/#cb112-463" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_results)</span>
<span id="cb112-464"><a href="http://localhost:6801/#cb112-464" aria-hidden="true" tabindex="-1"></a><span class="co">#Fisher LSD test</span></span>
<span id="cb112-465"><a href="http://localhost:6801/#cb112-465" aria-hidden="true" tabindex="-1"></a>lsd_result <span class="ot">&lt;-</span> <span class="fu">LSD.test</span>(anova_model, <span class="st">"treatment"</span>, <span class="at">p.adj=</span><span class="st">"none"</span>)</span>
<span id="cb112-466"><a href="http://localhost:6801/#cb112-466" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lsd_result)</span>
<span id="cb112-467"><a href="http://localhost:6801/#cb112-467" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lsd_result)</span>
<span id="cb112-468"><a href="http://localhost:6801/#cb112-468" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-469"><a href="http://localhost:6801/#cb112-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-470"><a href="http://localhost:6801/#cb112-470" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Interpretation**</span>
<span id="cb112-471"><a href="http://localhost:6801/#cb112-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-472"><a href="http://localhost:6801/#cb112-472" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Tukey post-HOC Test**</span>
<span id="cb112-473"><a href="http://localhost:6801/#cb112-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-474"><a href="http://localhost:6801/#cb112-474" aria-hidden="true" tabindex="-1"></a>        This test show us multiple comparisons between the treatments. <span class="in">`treat2-treat1`</span> show a p-value of 0.0044139 which is statically significant (p-value <span class="sc">\&lt;</span> 0.05) as same as <span class="in">`treat4-treat1`</span>, <span class="in">`treat5-treat1`</span>, <span class="in">`treat3-treat2`</span>, <span class="in">`treat5-treat5`</span>, <span class="in">`treat4-treat3`</span> and <span class="in">`treat5-treat3`</span>. Conversely, the comparisons between <span class="in">`treat3-treat1`</span> , <span class="in">`treat4-treat2`</span> and <span class="in">`treat5-treat4`</span> shows differences due to the p-value <span class="sc">\&gt;</span> 0.05.</span>
<span id="cb112-475"><a href="http://localhost:6801/#cb112-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-476"><a href="http://localhost:6801/#cb112-476" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Fisher-LSD Test**</span>
<span id="cb112-477"><a href="http://localhost:6801/#cb112-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-478"><a href="http://localhost:6801/#cb112-478" aria-hidden="true" tabindex="-1"></a>        According to the result, treatment 5 has the highest average length and is significantly different from the others. Treatments 4 and 2 are statistically similar to each other and have greater lengths than treatments 3 and 1, which are also similar to each other. The test highlights the differences between the treatments, reinforcing the ANOVA and Tukey results obtained previously.</span>
<span id="cb112-479"><a href="http://localhost:6801/#cb112-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-480"><a href="http://localhost:6801/#cb112-480" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb112-481"><a href="http://localhost:6801/#cb112-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-482"><a href="http://localhost:6801/#cb112-482" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q10. [Nested ANOVA]{.underline}</span></span>
<span id="cb112-483"><a href="http://localhost:6801/#cb112-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-484"><a href="http://localhost:6801/#cb112-484" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Read library &amp; data**</span>
<span id="cb112-485"><a href="http://localhost:6801/#cb112-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-488"><a href="http://localhost:6801/#cb112-488" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-489"><a href="http://localhost:6801/#cb112-489" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb112-490"><a href="http://localhost:6801/#cb112-490" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb112-491"><a href="http://localhost:6801/#cb112-491" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme) </span>
<span id="cb112-492"><a href="http://localhost:6801/#cb112-492" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"tree.xlsx"</span>)</span>
<span id="cb112-493"><a href="http://localhost:6801/#cb112-493" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data)</span>
<span id="cb112-494"><a href="http://localhost:6801/#cb112-494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-495"><a href="http://localhost:6801/#cb112-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-496"><a href="http://localhost:6801/#cb112-496" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Perform Anova**</span>
<span id="cb112-497"><a href="http://localhost:6801/#cb112-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-500"><a href="http://localhost:6801/#cb112-500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-501"><a href="http://localhost:6801/#cb112-501" aria-hidden="true" tabindex="-1"></a><span class="co">#Nested Anova</span></span>
<span id="cb112-502"><a href="http://localhost:6801/#cb112-502" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(Height <span class="sc">~</span> Forest<span class="sc">/</span>Tree, <span class="at">data=</span>data)</span>
<span id="cb112-503"><a href="http://localhost:6801/#cb112-503" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span>
<span id="cb112-504"><a href="http://localhost:6801/#cb112-504" aria-hidden="true" tabindex="-1"></a><span class="co">#Post Hoc</span></span>
<span id="cb112-505"><a href="http://localhost:6801/#cb112-505" aria-hidden="true" tabindex="-1"></a>HOC <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result, <span class="st">"Forest"</span>)</span>
<span id="cb112-506"><a href="http://localhost:6801/#cb112-506" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(HOC)</span>
<span id="cb112-507"><a href="http://localhost:6801/#cb112-507" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(HOC)</span>
<span id="cb112-508"><a href="http://localhost:6801/#cb112-508" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-509"><a href="http://localhost:6801/#cb112-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-510"><a href="http://localhost:6801/#cb112-510" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Interpretation**</span>
<span id="cb112-511"><a href="http://localhost:6801/#cb112-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-512"><a href="http://localhost:6801/#cb112-512" aria-hidden="true" tabindex="-1"></a>According to the summary, the effect of the forest on the type of tree seems to have a significant impact with the Forest variable (p-value = 6.55e-15 <span class="sc">\&lt;</span> 0.05) and the <span class="in">`Forest:Tree`</span> interaction (p-value = 0.000572 <span class="sc">\&lt;</span> 0.05) statistically significant. Moreover, according to the post-HOC test, all the groups show statistically significant differences (p-value <span class="sc">\&lt;</span> 0.05).</span>
<span id="cb112-513"><a href="http://localhost:6801/#cb112-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-514"><a href="http://localhost:6801/#cb112-514" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb112-515"><a href="http://localhost:6801/#cb112-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-516"><a href="http://localhost:6801/#cb112-516" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q11. [Two-Way ANOVA without replication]{.underline}</span></span>
<span id="cb112-517"><a href="http://localhost:6801/#cb112-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-518"><a href="http://localhost:6801/#cb112-518" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Read libraries &amp; data**</span>
<span id="cb112-519"><a href="http://localhost:6801/#cb112-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-522"><a href="http://localhost:6801/#cb112-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-523"><a href="http://localhost:6801/#cb112-523" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"student.xlsx"</span>)</span>
<span id="cb112-524"><a href="http://localhost:6801/#cb112-524" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Students <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>Students)</span>
<span id="cb112-525"><a href="http://localhost:6801/#cb112-525" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-526"><a href="http://localhost:6801/#cb112-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-527"><a href="http://localhost:6801/#cb112-527" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Perform a Two-Way ANOVA**</span>
<span id="cb112-528"><a href="http://localhost:6801/#cb112-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-531"><a href="http://localhost:6801/#cb112-531" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-532"><a href="http://localhost:6801/#cb112-532" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-way ANOVA without replication</span></span>
<span id="cb112-533"><a href="http://localhost:6801/#cb112-533" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(score <span class="sc">~</span> Subject, <span class="at">data =</span> data)</span>
<span id="cb112-534"><a href="http://localhost:6801/#cb112-534" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span>
<span id="cb112-535"><a href="http://localhost:6801/#cb112-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-536"><a href="http://localhost:6801/#cb112-536" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-way ANOVA with replication</span></span>
<span id="cb112-537"><a href="http://localhost:6801/#cb112-537" aria-hidden="true" tabindex="-1"></a>anova_result2 <span class="ot">&lt;-</span> <span class="fu">aov</span>(score <span class="sc">~</span> Subject <span class="sc">+</span> Students, <span class="at">data=</span>data)</span>
<span id="cb112-538"><a href="http://localhost:6801/#cb112-538" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result2)</span>
<span id="cb112-539"><a href="http://localhost:6801/#cb112-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-540"><a href="http://localhost:6801/#cb112-540" aria-hidden="true" tabindex="-1"></a><span class="co"># Post hoc analysis using Tukeys HSD without replication</span></span>
<span id="cb112-541"><a href="http://localhost:6801/#cb112-541" aria-hidden="true" tabindex="-1"></a>tukey_posthoc <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb112-542"><a href="http://localhost:6801/#cb112-542" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tukey_posthoc)</span>
<span id="cb112-543"><a href="http://localhost:6801/#cb112-543" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_posthoc)</span>
<span id="cb112-544"><a href="http://localhost:6801/#cb112-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-545"><a href="http://localhost:6801/#cb112-545" aria-hidden="true" tabindex="-1"></a><span class="co"># Post hoc with replication</span></span>
<span id="cb112-546"><a href="http://localhost:6801/#cb112-546" aria-hidden="true" tabindex="-1"></a>tukey_posthoc1 <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result2)</span>
<span id="cb112-547"><a href="http://localhost:6801/#cb112-547" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tukey_posthoc1)</span>
<span id="cb112-548"><a href="http://localhost:6801/#cb112-548" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_posthoc1)</span>
<span id="cb112-549"><a href="http://localhost:6801/#cb112-549" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-550"><a href="http://localhost:6801/#cb112-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-551"><a href="http://localhost:6801/#cb112-551" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Interpretation**</span>
<span id="cb112-552"><a href="http://localhost:6801/#cb112-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-553"><a href="http://localhost:6801/#cb112-553" aria-hidden="true" tabindex="-1"></a>According to the results of the post-HOC test, significant differences can be observed between different groups: <span class="in">`Science-Math`</span> group had significant differences (p-value = 0.0006975 <span class="sc">\&lt;</span> 0.05), as did the <span class="in">`Science-Reading`</span> group (p-value = 0.0075835 <span class="sc">\&lt;</span> 0.05). From the results of the ANOVA with replication we can confirm the significant differences between the 2 groups but also add that there is a difference with the <span class="in">`Social-Science`</span> group (p-value = 0.0236680 <span class="sc">\&lt;</span> 0.05) and also between the groups of students <span class="in">`5-1`</span> (p-value = 0.0403442 <span class="sc">\&lt;</span> 0.05), this model gives us more details on the results of the statistical significance.</span>
<span id="cb112-554"><a href="http://localhost:6801/#cb112-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-555"><a href="http://localhost:6801/#cb112-555" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**ANOVA without replication**</span>
<span id="cb112-556"><a href="http://localhost:6801/#cb112-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-557"><a href="http://localhost:6801/#cb112-557" aria-hidden="true" tabindex="-1"></a>The ANOVA without replication is useful when we have a group and the measurement is based on one condition and we can only test it once (independent sample), as in this case. This model compares the means between the groups to determine the significant values.&nbsp;</span>
<span id="cb112-558"><a href="http://localhost:6801/#cb112-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-559"><a href="http://localhost:6801/#cb112-559" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**ANOVA with replication**</span>
<span id="cb112-560"><a href="http://localhost:6801/#cb112-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-561"><a href="http://localhost:6801/#cb112-561" aria-hidden="true" tabindex="-1"></a>In the case of an ANOVA with replication, there are two independent variables, in this case Student &amp; Subjects, which makes it possible to analyse several combinations between these two factors. Having multiple observations within each combination allows a more reliable assessment of the effects of each factor and the interactions between them. As we can see from the results, replication allows the statistical power of the test to be more accurate, thus increasing confidence in the results relating to the effect of each variable and their potential interaction.</span>
<span id="cb112-562"><a href="http://localhost:6801/#cb112-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-563"><a href="http://localhost:6801/#cb112-563" aria-hidden="true" tabindex="-1"></a>{{&lt; pagebreak &gt;}}</span>
<span id="cb112-564"><a href="http://localhost:6801/#cb112-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-565"><a href="http://localhost:6801/#cb112-565" aria-hidden="true" tabindex="-1"></a><span class="fu">## Q12. [Two-Way ANOVA with replication]{.underline}</span></span>
<span id="cb112-566"><a href="http://localhost:6801/#cb112-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-567"><a href="http://localhost:6801/#cb112-567" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Read the data &amp; Load libraries**</span>
<span id="cb112-568"><a href="http://localhost:6801/#cb112-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-571"><a href="http://localhost:6801/#cb112-571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-572"><a href="http://localhost:6801/#cb112-572" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading required libraries</span></span>
<span id="cb112-573"><a href="http://localhost:6801/#cb112-573" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb112-574"><a href="http://localhost:6801/#cb112-574" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb112-575"><a href="http://localhost:6801/#cb112-575" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"blood_measure.xlsx"</span>)</span>
<span id="cb112-576"><a href="http://localhost:6801/#cb112-576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-577"><a href="http://localhost:6801/#cb112-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-578"><a href="http://localhost:6801/#cb112-578" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Two way ANOVA**</span>
<span id="cb112-579"><a href="http://localhost:6801/#cb112-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-582"><a href="http://localhost:6801/#cb112-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb112-583"><a href="http://localhost:6801/#cb112-583" aria-hidden="true" tabindex="-1"></a><span class="co"># Two-way ANOVA for measure</span></span>
<span id="cb112-584"><a href="http://localhost:6801/#cb112-584" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(measure <span class="sc">~</span> sex <span class="sc">*</span> age, <span class="at">data =</span> data1)</span>
<span id="cb112-585"><a href="http://localhost:6801/#cb112-585" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span>
<span id="cb112-586"><a href="http://localhost:6801/#cb112-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-587"><a href="http://localhost:6801/#cb112-587" aria-hidden="true" tabindex="-1"></a>posthoc <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result, <span class="at">which =</span> <span class="st">"age"</span>)</span>
<span id="cb112-588"><a href="http://localhost:6801/#cb112-588" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(posthoc)</span>
<span id="cb112-589"><a href="http://localhost:6801/#cb112-589" aria-hidden="true" tabindex="-1"></a><span class="co"># Post hoc analysis</span></span>
<span id="cb112-590"><a href="http://localhost:6801/#cb112-590" aria-hidden="true" tabindex="-1"></a>tukey_result <span class="ot">&lt;-</span> <span class="fu">TukeyHSD</span>(anova_result)</span>
<span id="cb112-591"><a href="http://localhost:6801/#cb112-591" aria-hidden="true" tabindex="-1"></a>tukey_result</span>
<span id="cb112-592"><a href="http://localhost:6801/#cb112-592" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tukey_result)</span>
<span id="cb112-593"><a href="http://localhost:6801/#cb112-593" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb112-594"><a href="http://localhost:6801/#cb112-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-595"><a href="http://localhost:6801/#cb112-595" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Interpretation**</span>
<span id="cb112-596"><a href="http://localhost:6801/#cb112-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-597"><a href="http://localhost:6801/#cb112-597" aria-hidden="true" tabindex="-1"></a>According to the summary of the two-way ANOVA, <span class="in">`age`</span> has a significant impact (p-value <span class="sc">\&lt;</span> 0.05) on <span class="in">`blood_measurement`</span>, whereas <span class="in">`sex`</span> does not appear to have any. The <span class="in">`age:sex`</span> interraction is significant (p-value <span class="sc">\&lt;</span> 0.05), thus showing that sex has an impact on blood measurement with age. As shown by the Tukey results, there are significant differences between <span class="in">`M:young-F:young`</span> (p-value = 0.0008841 <span class="sc">\&lt;</span> 0.05) et <span class="in">`M:young-M:old`</span> (p-value = 0.0000676 <span class="sc">\&lt;</span> 0.05)</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<div class="modal__dialog micromodal-slide" id="quarto-log-error-modal" aria-hidden="true">
  <div class="modal__overlay" tabindex="2" data-micromodal-close="">
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="quarto-log-error-modal-title">
      <header class="modal__header">
        <h2 class="modal__title" id="quarto-log-error-modal-title">
          <i class="bi bi-exclamation-circle"></i>Error
        </h2>
        <button class="modal__close" aria-label="Close modal" data-micromodal-close=""></button>
      </header>
      <div class="modal__content" id="quarto-log-error-modal-content">
        <pre tabindex="1" id="quarto-log-error-display"></pre>
      </div>
      <footer class="modal__footer">
      </footer>
    </div>
  </div>
</div>
<style type="text/css">
#quarto-log-error-modal .modal__overlay {
  z-index: 5000;
}
#quarto-log-error-modal-content {
  border: 1px solid #dee2e6;
  overflow-y: auto;
}
#quarto-log-error-display {
  min-height: 100px;
  padding: 8px;
  margin-bottom: 0;
  font-family: monospace;
}
#quarto-log-error-display:focus {
  outline: none;
}
.modal__dialog {
  font-size: 16px;
}
.modal__overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.4);
  display: flex;
  justify-content: center;
  align-items: center;
}
.modal__container {
  position: fixed;
  top: 80px;
  background-color: #fff;
  padding: 15px;
  padding-top: 10px;
  min-width: 500px;
  max-width: 90%;
  max-height: 90vh;
  border-radius: 4px;
  overflow-y: auto;
  box-sizing: border-box;
}
.modal__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.modal__title {
  margin-top: 0;
  margin-bottom: 0;
  font-weight: 600;
  border-bottom: none;
  padding-bottom: 10px;
  font-size: 20px;
  color: rgb(191,71,65);
  line-height: 1.25;
  box-sizing: border-box;
}
.modal__title .bi {
  margin-right: 7px;
}
.modal__close {
  background: transparent;
  border: 0;
  margin-bottom: 10px;
}
.modal__header .modal__close:before { content: "\2715"; }
.modal__content {
  margin-top: 0;
  margin-bottom: 0;
}
@keyframes mmfadeIn {
    from { opacity: 0; }
      to { opacity: 1; }
}
@keyframes mmfadeOut {
    from { opacity: 1; }
      to { opacity: 0; }
}
@keyframes mmslideIn {
  from { transform: translateY(15%); }
    to { transform: translateY(0); }
}
@keyframes mmslideOut {
    from { transform: translateY(0); }
    to { transform: translateY(-10%); }
}
.micromodal-slide {
  display: none;
}
.micromodal-slide.is-open {
  display: block;
}
.micromodal-slide[aria-hidden="false"] .modal__overlay {
  animation: mmfadeIn .3s cubic-bezier(0.0, 0.0, 0.2, 1);
}
.micromodal-slide[aria-hidden="false"] .modal__container {
  animation: mmslideIn .3s cubic-bezier(0, 0, .2, 1);
}
.micromodal-slide[aria-hidden="true"] .modal__overlay {
  animation: mmfadeOut .3s cubic-bezier(0.0, 0.0, 0.2, 1);
}
.micromodal-slide[aria-hidden="true"] .modal__container {
  animation: mmslideOut .3s cubic-bezier(0, 0, .2, 1);
}
.micromodal-slide .modal__container,
.micromodal-slide .modal__overlay {
  will-change: transform;
} 
</style>
<script type="text/javascript">
  window.backupDefine = window.define; window.define = undefined;
  /*  ansi_up.js
   *  author : Dru Nelson
   *  license : MIT
   *  http://github.com/drudru/ansi_up
   */
   (function (root, factory) {
      if (typeof define === 'function' && define.amd) {
          // AMD. Register as an anonymous module.
          define(['exports'], factory);
      } else if (typeof exports === 'object' && typeof exports.nodeName !== 'string') {
          // CommonJS
          factory(exports);
      } else {
          // Browser globals
          var exp = {};
          factory(exp);
          root.AnsiUp = exp.default;
      }
  }(this, function (exports) {
  "use strict";
  var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {
      if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
      return cooked;
  };
  var PacketKind;
  (function (PacketKind) {
      PacketKind[PacketKind["EOS"] = 0] = "EOS";
      PacketKind[PacketKind["Text"] = 1] = "Text";
      PacketKind[PacketKind["Incomplete"] = 2] = "Incomplete";
      PacketKind[PacketKind["ESC"] = 3] = "ESC";
      PacketKind[PacketKind["Unknown"] = 4] = "Unknown";
      PacketKind[PacketKind["SGR"] = 5] = "SGR";
      PacketKind[PacketKind["OSCURL"] = 6] = "OSCURL";
  })(PacketKind || (PacketKind = {}));
  var AnsiUp = (function () {
      function AnsiUp() {
          this.VERSION = "5.1.0";
          this.setup_palettes();
          this._use_classes = false;
          this.bold = false;
          this.italic = false;
          this.underline = false;
          this.fg = this.bg = null;
          this._buffer = '';
          this._url_whitelist = { 'http': 1, 'https': 1 };
      }
      Object.defineProperty(AnsiUp.prototype, "use_classes", {
          get: function () {
              return this._use_classes;
          },
          set: function (arg) {
              this._use_classes = arg;
          },
          enumerable: false,
          configurable: true
      });
      Object.defineProperty(AnsiUp.prototype, "url_whitelist", {
          get: function () {
              return this._url_whitelist;
          },
          set: function (arg) {
              this._url_whitelist = arg;
          },
          enumerable: false,
          configurable: true
      });
      AnsiUp.prototype.setup_palettes = function () {
          var _this = this;
          this.ansi_colors =
              [
                  [
                      { rgb: [0, 0, 0], class_name: "ansi-black" },
                      { rgb: [187, 0, 0], class_name: "ansi-red" },
                      { rgb: [0, 187, 0], class_name: "ansi-green" },
                      { rgb: [187, 187, 0], class_name: "ansi-yellow" },
                      { rgb: [0, 0, 187], class_name: "ansi-blue" },
                      { rgb: [187, 0, 187], class_name: "ansi-magenta" },
                      { rgb: [0, 187, 187], class_name: "ansi-cyan" },
                      { rgb: [255, 255, 255], class_name: "ansi-white" }
                  ],
                  [
                      { rgb: [85, 85, 85], class_name: "ansi-bright-black" },
                      { rgb: [255, 85, 85], class_name: "ansi-bright-red" },
                      { rgb: [0, 255, 0], class_name: "ansi-bright-green" },
                      { rgb: [255, 255, 85], class_name: "ansi-bright-yellow" },
                      { rgb: [85, 85, 255], class_name: "ansi-bright-blue" },
                      { rgb: [255, 85, 255], class_name: "ansi-bright-magenta" },
                      { rgb: [85, 255, 255], class_name: "ansi-bright-cyan" },
                      { rgb: [255, 255, 255], class_name: "ansi-bright-white" }
                  ]
              ];
          this.palette_256 = [];
          this.ansi_colors.forEach(function (palette) {
              palette.forEach(function (rec) {
                  _this.palette_256.push(rec);
              });
          });
          var levels = [0, 95, 135, 175, 215, 255];
          for (var r = 0; r < 6; ++r) {
              for (var g = 0; g < 6; ++g) {
                  for (var b = 0; b < 6; ++b) {
                      var col = { rgb: [levels[r], levels[g], levels[b]], class_name: 'truecolor' };
                      this.palette_256.push(col);
                  }
              }
          }
          var grey_level = 8;
          for (var i = 0; i < 24; ++i, grey_level += 10) {
              var gry = { rgb: [grey_level, grey_level, grey_level], class_name: 'truecolor' };
              this.palette_256.push(gry);
          }
      };
      AnsiUp.prototype.escape_txt_for_html = function (txt) {
          return txt.replace(/[&<>"']/gm, function (str) {
              if (str === "&")
                  return "&amp;";
              if (str === "<")
                  return "&lt;";
              if (str === ">")
                  return "&gt;";
              if (str === "\"")
                  return "&quot;";
              if (str === "'")
                  return "&#x27;";
          });
      };
      AnsiUp.prototype.append_buffer = function (txt) {
          var str = this._buffer + txt;
          this._buffer = str;
      };
      AnsiUp.prototype.get_next_packet = function () {
          var pkt = {
              kind: PacketKind.EOS,
              text: '',
              url: ''
          };
          var len = this._buffer.length;
          if (len == 0)
              return pkt;
          var pos = this._buffer.indexOf("\x1B");
          if (pos == -1) {
              pkt.kind = PacketKind.Text;
              pkt.text = this._buffer;
              this._buffer = '';
              return pkt;
          }
          if (pos > 0) {
              pkt.kind = PacketKind.Text;
              pkt.text = this._buffer.slice(0, pos);
              this._buffer = this._buffer.slice(pos);
              return pkt;
          }
          if (pos == 0) {
              if (len == 1) {
                  pkt.kind = PacketKind.Incomplete;
                  return pkt;
              }
              var next_char = this._buffer.charAt(1);
              if ((next_char != '[') && (next_char != ']')) {
                  pkt.kind = PacketKind.ESC;
                  pkt.text = this._buffer.slice(0, 1);
                  this._buffer = this._buffer.slice(1);
                  return pkt;
              }
              if (next_char == '[') {
                  if (!this._csi_regex) {
                      this._csi_regex = rgx(__makeTemplateObject(["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \u001B[                      # CSI\n                          ([<-?]?)              # private-mode char\n                          ([d;]*)                    # any digits or semicolons\n                          ([ -/]?               # an intermediate modifier\n                          [@-~])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \u001B[                      # CSI\n                          [ -~]*                # anything legal\n                          ([\0-\u001F:])              # anything illegal\n                        )\n                    "], ["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \\x1b\\[                      # CSI\n                          ([\\x3c-\\x3f]?)              # private-mode char\n                          ([\\d;]*)                    # any digits or semicolons\n                          ([\\x20-\\x2f]?               # an intermediate modifier\n                          [\\x40-\\x7e])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \\x1b\\[                      # CSI\n                          [\\x20-\\x7e]*                # anything legal\n                          ([\\x00-\\x1f:])              # anything illegal\n                        )\n                    "]));
                  }
                  var match = this._buffer.match(this._csi_regex);
                  if (match === null) {
                      pkt.kind = PacketKind.Incomplete;
                      return pkt;
                  }
                  if (match[4]) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  if ((match[1] != '') || (match[3] != 'm'))
                      pkt.kind = PacketKind.Unknown;
                  else
                      pkt.kind = PacketKind.SGR;
                  pkt.text = match[2];
                  var rpos = match[0].length;
                  this._buffer = this._buffer.slice(rpos);
                  return pkt;
              }
              if (next_char == ']') {
                  if (len < 4) {
                      pkt.kind = PacketKind.Incomplete;
                      return pkt;
                  }
                  if ((this._buffer.charAt(2) != '8')
                      || (this._buffer.charAt(3) != ';')) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  if (!this._osc_st) {
                      this._osc_st = rgxG(__makeTemplateObject(["\n                        (?:                         # legal sequence\n                          (\u001B\\)                    # ESC                           |                           # alternate\n                          (\u0007)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\0-\u0006]                 # anything illegal\n                          |                           # alternate\n                          [\b-\u001A]                 # anything illegal\n                          |                           # alternate\n                          [\u001C-\u001F]                 # anything illegal\n                        )\n                    "], ["\n                        (?:                         # legal sequence\n                          (\\x1b\\\\)                    # ESC \\\n                          |                           # alternate\n                          (\\x07)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\\x00-\\x06]                 # anything illegal\n                          |                           # alternate\n                          [\\x08-\\x1a]                 # anything illegal\n                          |                           # alternate\n                          [\\x1c-\\x1f]                 # anything illegal\n                        )\n                    "]));
                  }
                  this._osc_st.lastIndex = 0;
                  {
                      var match_1 = this._osc_st.exec(this._buffer);
                      if (match_1 === null) {
                          pkt.kind = PacketKind.Incomplete;
                          return pkt;
                      }
                      if (match_1[3]) {
                          pkt.kind = PacketKind.ESC;
                          pkt.text = this._buffer.slice(0, 1);
                          this._buffer = this._buffer.slice(1);
                          return pkt;
                      }
                  }
                  {
                      var match_2 = this._osc_st.exec(this._buffer);
                      if (match_2 === null) {
                          pkt.kind = PacketKind.Incomplete;
                          return pkt;
                      }
                      if (match_2[3]) {
                          pkt.kind = PacketKind.ESC;
                          pkt.text = this._buffer.slice(0, 1);
                          this._buffer = this._buffer.slice(1);
                          return pkt;
                      }
                  }
                  if (!this._osc_regex) {
                      this._osc_regex = rgx(__makeTemplateObject(["\n                        ^                           # beginning of line\n                                                    #\n                        \u001B]8;                    # OSC Hyperlink\n                        [ -:<-~]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([!-~]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                        ([ -~]+)              # TEXT capture\n                        \u001B]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                    "], ["\n                        ^                           # beginning of line\n                                                    #\n                        \\x1b\\]8;                    # OSC Hyperlink\n                        [\\x20-\\x3a\\x3c-\\x7e]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([\\x21-\\x7e]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                        ([\\x20-\\x7e]+)              # TEXT capture\n                        \\x1b\\]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                    "]));
                  }
                  var match = this._buffer.match(this._osc_regex);
                  if (match === null) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  pkt.kind = PacketKind.OSCURL;
                  pkt.url = match[1];
                  pkt.text = match[2];
                  var rpos = match[0].length;
                  this._buffer = this._buffer.slice(rpos);
                  return pkt;
              }
          }
      };
      AnsiUp.prototype.ansi_to_html = function (txt) {
          this.append_buffer(txt);
          var blocks = [];
          while (true) {
              var packet = this.get_next_packet();
              if ((packet.kind == PacketKind.EOS)
                  || (packet.kind == PacketKind.Incomplete))
                  break;
              if ((packet.kind == PacketKind.ESC)
                  || (packet.kind == PacketKind.Unknown))
                  continue;
              if (packet.kind == PacketKind.Text)
                  blocks.push(this.transform_to_html(this.with_state(packet)));
              else if (packet.kind == PacketKind.SGR)
                  this.process_ansi(packet);
              else if (packet.kind == PacketKind.OSCURL)
                  blocks.push(this.process_hyperlink(packet));
          }
          return blocks.join("");
      };
      AnsiUp.prototype.with_state = function (pkt) {
          return { bold: this.bold, italic: this.italic, underline: this.underline, fg: this.fg, bg: this.bg, text: pkt.text };
      };
      AnsiUp.prototype.process_ansi = function (pkt) {
          var sgr_cmds = pkt.text.split(';');
          while (sgr_cmds.length > 0) {
              var sgr_cmd_str = sgr_cmds.shift();
              var num = parseInt(sgr_cmd_str, 10);
              if (isNaN(num) || num === 0) {
                  this.fg = this.bg = null;
                  this.bold = false;
                  this.italic = false;
                  this.underline = false;
              }
              else if (num === 1) {
                  this.bold = true;
              }
              else if (num === 3) {
                  this.italic = true;
              }
              else if (num === 4) {
                  this.underline = true;
              }
              else if (num === 22) {
                  this.bold = false;
              }
              else if (num === 23) {
                  this.italic = false;
              }
              else if (num === 24) {
                  this.underline = false;
              }
              else if (num === 39) {
                  this.fg = null;
              }
              else if (num === 49) {
                  this.bg = null;
              }
              else if ((num >= 30) && (num < 38)) {
                  this.fg = this.ansi_colors[0][(num - 30)];
              }
              else if ((num >= 40) && (num < 48)) {
                  this.bg = this.ansi_colors[0][(num - 40)];
              }
              else if ((num >= 90) && (num < 98)) {
                  this.fg = this.ansi_colors[1][(num - 90)];
              }
              else if ((num >= 100) && (num < 108)) {
                  this.bg = this.ansi_colors[1][(num - 100)];
              }
              else if (num === 38 || num === 48) {
                  if (sgr_cmds.length > 0) {
                      var is_foreground = (num === 38);
                      var mode_cmd = sgr_cmds.shift();
                      if (mode_cmd === '5' && sgr_cmds.length > 0) {
                          var palette_index = parseInt(sgr_cmds.shift(), 10);
                          if (palette_index >= 0 && palette_index <= 255) {
                              if (is_foreground)
                                  this.fg = this.palette_256[palette_index];
                              else
                                  this.bg = this.palette_256[palette_index];
                          }
                      }
                      if (mode_cmd === '2' && sgr_cmds.length > 2) {
                          var r = parseInt(sgr_cmds.shift(), 10);
                          var g = parseInt(sgr_cmds.shift(), 10);
                          var b = parseInt(sgr_cmds.shift(), 10);
                          if ((r >= 0 && r <= 255) && (g >= 0 && g <= 255) && (b >= 0 && b <= 255)) {
                              var c = { rgb: [r, g, b], class_name: 'truecolor' };
                              if (is_foreground)
                                  this.fg = c;
                              else
                                  this.bg = c;
                          }
                      }
                  }
              }
          }
      };
      AnsiUp.prototype.transform_to_html = function (fragment) {
          var txt = fragment.text;
          if (txt.length === 0)
              return txt;
          txt = this.escape_txt_for_html(txt);
          if (!fragment.bold && !fragment.italic && !fragment.underline && fragment.fg === null && fragment.bg === null)
              return txt;
          var styles = [];
          var classes = [];
          var fg = fragment.fg;
          var bg = fragment.bg;
          if (fragment.bold)
              styles.push('font-weight:bold');
          if (fragment.italic)
              styles.push('font-style:italic');
          if (fragment.underline)
              styles.push('text-decoration:underline');
          if (!this._use_classes) {
              if (fg)
                  styles.push("color:rgb(" + fg.rgb.join(',') + ")");
              if (bg)
                  styles.push("background-color:rgb(" + bg.rgb + ")");
          }
          else {
              if (fg) {
                  if (fg.class_name !== 'truecolor') {
                      classes.push(fg.class_name + "-fg");
                  }
                  else {
                      styles.push("color:rgb(" + fg.rgb.join(',') + ")");
                  }
              }
              if (bg) {
                  if (bg.class_name !== 'truecolor') {
                      classes.push(bg.class_name + "-bg");
                  }
                  else {
                      styles.push("background-color:rgb(" + bg.rgb.join(',') + ")");
                  }
              }
          }
          var class_string = '';
          var style_string = '';
          if (classes.length)
              class_string = " class=\"" + classes.join(' ') + "\"";
          if (styles.length)
              style_string = " style=\"" + styles.join(';') + "\"";
          return "<span" + style_string + class_string + ">" + txt + "</span>";
      };
      ;
      AnsiUp.prototype.process_hyperlink = function (pkt) {
          var parts = pkt.url.split(':');
          if (parts.length < 1)
              return '';
          if (!this._url_whitelist[parts[0]])
              return '';
          var result = "<a href=\"" + this.escape_txt_for_html(pkt.url) + "\">" + this.escape_txt_for_html(pkt.text) + "</a>";
          return result;
      };
      return AnsiUp;
  }());
  function rgx(tmplObj) {
      var subst = [];
      for (var _i = 1; _i < arguments.length; _i++) {
          subst[_i - 1] = arguments[_i];
      }
      var regexText = tmplObj.raw[0];
      var wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
      var txt2 = regexText.replace(wsrgx, '');
      return new RegExp(txt2);
  }
  function rgxG(tmplObj) {
      var subst = [];
      for (var _i = 1; _i < arguments.length; _i++) {
          subst[_i - 1] = arguments[_i];
      }
      var regexText = tmplObj.raw[0];
      var wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
      var txt2 = regexText.replace(wsrgx, '');
      return new RegExp(txt2, 'g');
  }
      Object.defineProperty(exports, "__esModule", { value: true });
      exports.default = AnsiUp;
  }));
  // micromodal: https://github.com/Ghosh/micromodal
  !function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).MicroModal=t()}(this,(function(){"use strict";function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var n,i,a,r,s,l=(n=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],i=function(){function o(e){var n=e.targetModal,i=e.triggers,a=void 0===i?[]:i,r=e.onShow,s=void 0===r?function(){}:r,l=e.onClose,c=void 0===l?function(){}:l,d=e.openTrigger,u=void 0===d?"data-micromodal-trigger":d,f=e.closeTrigger,h=void 0===f?"data-micromodal-close":f,v=e.openClass,g=void 0===v?"is-open":v,m=e.disableScroll,b=void 0!==m&&m,y=e.disableFocus,p=void 0!==y&&y,w=e.awaitCloseAnimation,E=void 0!==w&&w,k=e.awaitOpenAnimation,M=void 0!==k&&k,A=e.debugMode,C=void 0!==A&&A;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.modal=document.getElementById(n),this.config={debugMode:C,disableScroll:b,openTrigger:u,closeTrigger:h,openClass:g,onShow:s,onClose:c,awaitCloseAnimation:E,awaitOpenAnimation:M,disableFocus:p},a.length>0&&this.registerTriggers.apply(this,t(a)),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}var i,a,r;return i=o,(a=[{key:"registerTriggers",value:function(){for(var e=this,t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];o.filter(Boolean).forEach((function(t){t.addEventListener("click",(function(t){return e.showModal(t)}))}))}},{key:"showModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),this.modal.classList.add(this.config.openClass),this.scrollBehaviour("disable"),this.addEventListeners(),this.config.awaitOpenAnimation){var o=function t(){e.modal.removeEventListener("animationend",t,!1),e.setFocusToFirstNode()};this.modal.addEventListener("animationend",o,!1)}else this.setFocusToFirstNode();this.config.onShow(this.modal,this.activeElement,t)}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.modal;if(this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.scrollBehaviour("enable"),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.config.onClose(this.modal,this.activeElement,e),this.config.awaitCloseAnimation){var o=this.config.openClass;this.modal.addEventListener("animationend",(function e(){t.classList.remove(o),t.removeEventListener("animationend",e,!1)}),!1)}else t.classList.remove(this.config.openClass)}},{key:"closeModalById",value:function(e){this.modal=document.getElementById(e),this.modal&&this.closeModal()}},{key:"scrollBehaviour",value:function(e){if(this.config.disableScroll){var t=document.querySelector("body");switch(e){case"enable":Object.assign(t.style,{overflow:""});break;case"disable":Object.assign(t.style,{overflow:"hidden"})}}}},{key:"addEventListeners",value:function(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}},{key:"removeEventListeners",value:function(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}},{key:"onClick",value:function(e){(e.target.hasAttribute(this.config.closeTrigger)||e.target.parentNode.hasAttribute(this.config.closeTrigger))&&(e.preventDefault(),e.stopPropagation(),this.closeModal(e))}},{key:"onKeydown",value:function(e){27===e.keyCode&&this.closeModal(e),9===e.keyCode&&this.retainFocus(e)}},{key:"getFocusableNodes",value:function(){var e=this.modal.querySelectorAll(n);return Array.apply(void 0,t(e))}},{key:"setFocusToFirstNode",value:function(){var e=this;if(!this.config.disableFocus){var t=this.getFocusableNodes();if(0!==t.length){var o=t.filter((function(t){return!t.hasAttribute(e.config.closeTrigger)}));o.length>0&&o[0].focus(),0===o.length&&t[0].focus()}}}},{key:"retainFocus",value:function(e){var t=this.getFocusableNodes();if(0!==t.length)if(t=t.filter((function(e){return null!==e.offsetParent})),this.modal.contains(document.activeElement)){var o=t.indexOf(document.activeElement);e.shiftKey&&0===o&&(t[t.length-1].focus(),e.preventDefault()),!e.shiftKey&&t.length>0&&o===t.length-1&&(t[0].focus(),e.preventDefault())}else t[0].focus()}}])&&e(i.prototype,a),r&&e(i,r),o}(),a=null,r=function(e){if(!document.getElementById(e))return console.warn("MicroModal: ❗Seems like you have missed %c'".concat(e,"'"),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<div class="modal" id="'.concat(e,'"></div>')),!1},s=function(e,t){if(function(e){e.length<=0&&(console.warn("MicroModal: ❗Please specify at least one %c'micromodal-trigger'","background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<a href="#" data-micromodal-trigger="my-modal"></a>'))}(e),!t)return!0;for(var o in t)r(o);return!0},{init:function(e){var o=Object.assign({},{openTrigger:"data-micromodal-trigger"},e),n=t(document.querySelectorAll("[".concat(o.openTrigger,"]"))),r=function(e,t){var o=[];return e.forEach((function(e){var n=e.attributes[t].value;void 0===o[n]&&(o[n]=[]),o[n].push(e)})),o}(n,o.openTrigger);if(!0!==o.debugMode||!1!==s(n,r))for(var l in r){var c=r[l];o.targetModal=l,o.triggers=t(c),a=new i(o)}},show:function(e,t){var o=t||{};o.targetModal=e,!0===o.debugMode&&!1===r(e)||(a&&a.removeEventListeners(),(a=new i(o)).showModal())},close:function(e){e?a.closeModalById(e):a.closeModal()}});return"undefined"!=typeof window&&(window.MicroModal=l),l}));  
  window.define = window.backupDefine; window.backupDefine = undefined;
  </script>
<script type="text/javascript">
  (function () {
    // forward keydown events so shortcuts can work in vscode, see:
    // https://github.com/microsoft/vscode/issues/65452#issuecomment-586485815
    if (window.parent.postMessage) {
      window.document.addEventListener('keydown', e => {
        const event = {
          type: "keydown",
          data: {
            altKey: e.altKey,
            code: e.code,
            ctrlKey: e.ctrlKey,
            isComposing: e.isComposing,
            key: e.key,
            location: e.location,
            metaKey: e.metaKey,
            repeat: e.repeat,
            shiftKey: e.shiftKey
          }
        };
        window.parent.postMessage(event, '*');
      });
    }
    // listen for execCommand messages
    window.addEventListener("message", function (event) {
      if (event.data.type === "devhost-exec-command") {
        window.document.execCommand(event.data.data);
      } 
    }, true);
    const logEntries = new Array(1000);
    logEntries.offset = 0;
    function recordLogEntry(entry) {
      logEntries[logEntries.offset++] = entry;
      logEntries.offset %= logEntries.length;
    }
    function getLogEntry(i) { // backwards, 0 is most recent
        return logEntries[(logEntries.offset - 1 - i + logEntries.length) % logEntries.length];
    }
    const protocol = window.location.protocol === "https:" ? "wss:" : "ws:";
    let path = window.location.pathname;
    if (!/\/$/.test(path)) path += "/";
    const devServerSocket = new WebSocket(protocol + "//" + window.location.host + path);
    let reloadPage = true;
    addEventListener("beforeunload", () => {
      // don't reload page in case of navigation events
      reloadPage = false;
    })
    devServerSocket.onopen = () => {
      console.log('Socket connection open. Listening for events.');
      // if the socket closes for any reason (e.g. this occurs in electron apps
      // when the computer suspends) then reload to reestablish the connection 
      devServerSocket.onclose = () => {
        if (reloadPage) {
          console.log('Socket connection closed. Reloading.');
          window.location.reload(true);
        }
      }
    };
    // append for errors that occur within the error window
    let lastError = 0;
    const kErrorWindow = 2500;
    function showError(msg) {
      const ansiUp = new AnsiUp
      const html = ansiUp.ansi_to_html(msg.trim());
      const display = document.getElementById("quarto-log-error-display");
      if (display.innerHTML && ((Date.now() - lastError) < kErrorWindow)) {
        display.innerHTML = display.innerHTML + "<br/>" +  html;
      } else {
        display.innerHTML = html
      }
      lastError = Date.now()
      MicroModal.show('quarto-log-error-modal', {
        awaitCloseAnimation: true,
        onClose: () => { display.innerHTML = ""; }
      });
      // post message to parent indicating we had an error
      if (window.parent.postMessage) {
        window.parent.postMessage({
          type: "error",
          msg: msg,
        }, "*");
      }
    }
    // see if there is already an error to show
    const renderError = document.getElementById("quarto-render-error");
    if (renderError) {
      showError(renderError.innerHTML.trim());
    }
    const normalizeTarget = (target) => {
      return target.replace(/\/index\.html/, "/")
    };
    devServerSocket.onmessage = (msg) => {
      if (msg.data.startsWith('reload')) {
        let target = normalizeTarget(msg.data.replace(/^reload/, ""));
        // prepend proxy path to target if we have one
        if (target) {
          const pathPrefix = 
            window.location.pathname.match(/^.*?\/p\/\w+\//) ||
            window.location.pathname.match(/^.*?\/user\/[\w\d]+\/proxy\/\d+\//);
          if (pathPrefix) {
            target = pathPrefix + target.slice(1);
          }
        }
        if (target && (target !== normalizeTarget(window.location.pathname))) {
          window.location.replace(target);
        } else {
          window.location.reload(true);
        }
      } else if (msg.data.startsWith('log:')) {
        const ansiUp = new AnsiUp
        const log = JSON.parse(msg.data.substr(4));
        recordLogEntry(log);
        if (log.levelName === "ERROR") {
          showError(log.msgFormatted)
        } else {
          // see if there is a knitr error to report
          const kExecutionHalted = "Execution halted";
          if (log.msg.indexOf(kExecutionHalted) !== -1) {
            // scan backwards for beginning of error
            const errorEntries = [getLogEntry(0).msgFormatted];
            for (let i=1; i<logEntries.length; i++) {
              const logEntry = getLogEntry(i);
              if (logEntry) {
                errorEntries.unshift(logEntry.msgFormatted);
                if (logEntry.msg.indexOf("Quitting from lines") !== -1) {
                  showError(errorEntries.join(""));
                  break;
                } else if (logEntry.msg.indexOf(kExecutionHalted) !== -1) {
                  break;
                }
              } else {
                break;
              }
            }
          }
        }
      }
    };
  })();
</script>

<script type="text/javascript">
  if (window.parent.postMessage) {
    // wait for message providing confirmation we are in a devhost
    window.addEventListener("message", function (event) {
      if (event.data.type === "devhost-init") {
        window.quartoDevhost = {
          openInputFile: function (line, column, highlight) {
            window.parent.postMessage({
              type: "openfile",
              file: "C:\Users\uzanv\OneDrive\Documents\Asssignement_1\Assignement III_Valentin_Uzan.qmd",
              line: line,
              column: column,
              highlight: highlight
            }, event.origin);
          }
        };
      } else if (event.data.type === "goback") {
        window.history.back()
      } else if (event.data.type === "goforward") {
        window.history.forward()
      }
    }, true);
    // notify host of navigation (e.g. for 'pop out' command)
    window.parent.postMessage({
      type: "navigate",
      href: window.location.href,
      file: "C:\Users\uzanv\OneDrive\Documents\Asssignement_1\Assignement III_Valentin_Uzan.qmd"
    }, "*");
  }
</script>
<deepl-input-controller><template shadowrootmode="open"><link rel="stylesheet" href="chrome-extension://cofdbpoegempjloogbagkncekinflcnj/build/content.css"><div><div class="dl-input-translation-container svelte-ju4595"><div></div></div></div></template></deepl-input-controller></body><nordvpn-contentscript-extension-mount-3.6.0><template shadowrootmode="open"><link rel="stylesheet" href="chrome-extension://fjoaledfpmneenckfbpdfhkmimnjocfa/csHttp.bundle.css"><div id="nordvpn-contentScript-extension-root-3.6.0" style="position: fixed; left: 0px; top: 0px; z-index: 2147483647;"></div></template></nordvpn-contentscript-extension-mount-3.6.0></html>